(self.webpackChunk=self.webpackChunk||[]).push([[6111],{16111:(e,t,r)=>{r.r(t),r.d(t,{BugReportForm:()=>E});var a=r(92379),n=r(53768),o=r(50635),l=r(31702),i=r(83542),s=r(52348),c=r(69554),u=r(405),g=r(39397),d=r(21553),p=r(4517),m=r(44675),h=r(20905),b=r(40594),f=r(29483),x=r(35159);const y=b.Y.create("BugReportUtils");async function k(){try{if(!(0,f.OB)().historyLogsService.isHistoryEnabled())return y.debug("debug reports feature is not enabled"),null;const e=[];try{await(0,m.Fb)(h.E0,async function(){y.info("latest experiments state",await(0,f.OB)().bgRpc.api.getExperimentTreatment()),y.info("latest storage state",await(0,f.OB)().browserApi.preferences.getAll()),y.info("browser info",(0,f.OB)().browserApi.getBrowserInfo())}())}catch(e){y.warn("cannot get latest app state",e)}const t=function(){if("sidePanel"===(0,f.OB)().context)return(0,x.$)();return(0,p.m)()}();t.sort((e=>e.envName===(0,f.OB)().context?1:-1));for(const r of t){const t=await r.getLogs();e.push(...null!=t?t:[])}e.sort(((e,t)=>e.timestamp-t.timestamp));const r=function(e){const t=e=>{try{return JSON.stringify(e)}catch(t){return String(e)}};return[["Level","Logger","Timestamp","Message"].join("\t"),...e.map((e=>{const r=[e.level,e.loggerName,new Date(e.timestamp).toISOString(),e.message];return e.data&&r.push(t(e.data)),e.exception&&r.push(t(e.exception)),r.join("\t")}))].join("\n")}(e),a=`grammarly-logs-${(new Date).toISOString().replace(/[:.]/g,"-")}.tsv`;return new File([r],a,{type:"text/tab-separated-values"})}catch(e){return y.error("Failed to generate debug logs file",e),null}}const v={dark:{background:n.NeutralGray90,text:n.NeutralGray10,border:n.NeutralGray80,helperText:n.NeutralGray30,link:n.Blue40,error:n.Red40,calloutBg:n.NeutralGray80,calloutBorder:n.NeutralGray60,calloutText:n.NeutralGray20},light:{background:n.White,text:n.NeutralGray90,border:"transparent",helperText:n.NeutralGray40,link:n.Blue60,error:n.Red60,calloutBg:n.NeutralGray10,calloutBorder:n.NeutralGray20,calloutText:n.NeutralGray80},backdropDark:"rgba(0, 0, 0, 0.8)",backdropLight:"rgba(0, 0, 0, 0.5)",shadowDark:"0 8px 16px rgba(0, 0, 0, 0.24)",shadowLight:"0 8px 16px rgba(0, 0, 0, 0.15)"},E=({isOpen:e,onClose:t,onSubmit:r})=>{const[n,p]=a.useState(""),[m,h]=a.useState(""),[b,f]=a.useState([]),[x,y]=a.useState(!1),[E,w]=a.useState(!1),[S,L]=a.useState(null),[B,T]=a.useState(null),F=a.useRef(null),C=a.useRef(null),[R,N]=a.useState((0,g.Y)()),O=(0,d.G)();a.useEffect((()=>{const e=self.matchMedia("(prefers-color-scheme: dark)"),t=()=>N(e.matches);return e.addEventListener("change",t),()=>e.removeEventListener("change",t)}),[]),a.useEffect((()=>{e&&O.trackFormOpen()}),[e,O]),a.useEffect((()=>{e&&C.current&&C.current.focus();const r=e=>{"Escape"===e.key&&t()};return e&&document.addEventListener("keydown",r),()=>{document.removeEventListener("keydown",r)}}),[e,t]);const G=a.useMemo((()=>(e=>{const t=e?v.dark:v.light;return{backdrop:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:e?v.backdropDark:v.backdropLight,display:"flex",alignItems:"center",justifyContent:"center",zIndex:9999},dialog:{backgroundColor:t.background,color:t.text,borderRadius:"8px",padding:"20px",maxWidth:"500px",width:"90%",maxHeight:"85%",overflow:"auto",border:e?`1px solid ${t.border}`:"none",boxShadow:e?v.shadowDark:v.shadowLight},helperText:{opacity:.7,color:t.helperText},hiddenFileInput:{display:"none"},ticketLink:{color:t.link,textDecoration:"underline",cursor:"pointer",fontSize:"14px"},errorText:{color:t.error},clickableLabel:{cursor:"pointer"},fileText:{flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",marginRight:"8px"},calloutBox:{backgroundColor:t.calloutBg,border:`1px solid ${t.calloutBorder}`,borderRadius:"6px",padding:"10px 12px",margin:"0"},calloutText:{color:t.calloutText,fontSize:"13px",lineHeight:"1.4"},successMessage:{fontSize:"15px",lineHeight:"1.6",color:t.text,fontWeight:500},successLink:{color:t.link,textDecoration:"none",fontSize:"14px",fontWeight:500,display:"inline-block",marginTop:"4px"}}})(R)),[R]);return e?a.createElement("div",{role:"presentation",style:G.backdrop,onMouseDown:e=>{e.target===e.currentTarget&&t()}},a.createElement("div",{ref:C,role:"dialog","aria-modal":"true","aria-labelledby":"bug-report-title",style:G.dialog,tabIndex:-1},B?a.createElement(a.Fragment,null,a.createElement(o.k,{direction:"column",align:"start",gap:3},a.createElement(l.x,{as:"p",style:G.successMessage,id:"bug-report-title"},(()=>{const e=[{bold:"Thanks a ton!",rest:" You just made Superhuman even more super — we'll take it from here."},{bold:"Bug spotted!",rest:" Thanks for helping us squash it — your feedback keeps us flying."},{bold:"Appreciate the catch!",rest:" Every bug report brings us one step closer to perfection."},{bold:"You've got eagle eyes",rest:" — thank you for helping us make things smoother!"},{bold:"Thanks for flagging that!",rest:" We're on it faster than a keyboard shortcut."},{bold:"You found a glitch in the Matrix",rest:" — and we appreciate the heads-up!"},{bold:"Big thanks!",rest:" Your feedback keeps our code (and our team) in top shape."},{bold:"Thanks for the bug report!",rest:" We'll handle it from here — no exterminator required."},{bold:"Got it!",rest:" Thanks for helping us debug our way to brilliance."},{bold:"Appreciate the assist!",rest:" You just made the experience better for everyone."}],t=e[Math.floor(Math.random()*e.length)];return a.createElement(a.Fragment,null,a.createElement("strong",null,t.bold),t.rest)})()),a.createElement(i.x,null,a.createElement("a",{href:B.ticketUrl,target:"_blank",rel:"noopener noreferrer",style:G.successLink},"See your bug report"))),a.createElement(o.k,{gap:2,justify:"end",marginTop:6},a.createElement(s.z,{variant:"primary",text:"Done",onClick:()=>{T(null),t()}}))):a.createElement(a.Fragment,null,a.createElement(c.X,{as:"h2",variant:"heading-medium",marginBottom:2,id:"bug-report-title"},"Report a Bug"),a.createElement(o.k,{direction:"column",gap:3},a.createElement(i.x,null,a.createElement(u.g,{label:"Title",placeholder:"Briefly describe the issue",value:n,onChange:p,rows:1})),a.createElement(i.x,null,a.createElement(u.g,{label:"Description",placeholder:"Provide details about what went wrong and steps to reproduce the issue",value:m,onChange:h})),a.createElement(i.x,null,a.createElement(l.x,{as:"span",variant:"text-small",weight:"medium",color:"base-default"},"Attachment (optional)"),a.createElement(o.k,{direction:"column",gap:2,marginTop:1},a.createElement("input",{ref:F,type:"file",accept:"image/*,video/*",multiple:!0,onChange:e=>{(async e=>{const t=Array.from(e.target.files||[]);if(t.length>0){const r=["image/png","image/jpeg","image/gif","video/mp4","video/mov","video/quicktime","video/avi","video/x-msvideo"],a=t.filter((e=>r.includes(e.type)));if(a.length>0){const e=(await Promise.all(a.map((async e=>{try{const t=await e.arrayBuffer();return new File([t],e.name,{type:e.type})}catch(e){return null}})))).filter((e=>null!==e));e.length>0&&f((t=>[...t,...e]))}e.target.value=""}})(e)},style:G.hiddenFileInput,id:"bug-report-file"}),a.createElement(o.k,{gap:2},a.createElement(s.z,{variant:"secondary",text:"Choose Files",onClick:()=>{var e;return null===(e=F.current)||void 0===e?void 0:e.click()}}),b.length>0&&a.createElement(s.z,{variant:"ghost",text:"Clear All",size:"small",onClick:()=>{f([]),F.current&&(F.current.value="")}})),b.length>0&&a.createElement(o.k,{direction:"column",gap:1},b.map(((e,t)=>a.createElement(o.k,{key:`${e.name}-${t}`,align:"center",gap:2},a.createElement(l.x,{as:"span",variant:"text-small",color:"base-default",style:G.fileText},e.name," (",Math.round(e.size/1024)," KB)"),a.createElement(s.z,{variant:"ghost",text:"Remove",size:"small",onClick:()=>(e=>{f((t=>t.filter(((t,r)=>r!==e))))})(t),style:{flexShrink:0}}))))))),a.createElement(i.x,{style:G.calloutBox},a.createElement(l.x,{as:"span",variant:"text-small",style:G.calloutText},"⚠️ Logs will be auto-collected and may include a portion of your text to help us investigate the issue.")),S&&a.createElement(i.x,null,a.createElement(l.x,{as:"span",variant:"text-small",style:G.errorText},"❌ ",S))),a.createElement(o.k,{gap:2,justify:"end",marginTop:3},a.createElement(s.z,{variant:"secondary",text:"Cancel",onClick:()=>{O.trackFormCancel(),t()},isDisabled:x}),a.createElement(s.z,{variant:"primary",text:E?"Collecting logs...":x?"Submitting...":"Submit",onClick:async()=>{if(n.trim()&&m.trim()){O.trackFormSubmit(),y(!0),w(!0),L(null);try{const e=await k();if(!e)throw new Error("Failed to collect debug logs");w(!1);const t=await r({title:n.trim(),description:m.trim(),attachments:b,debugLogs:e});T(t),L(null),O.trackSuccessPopupShow(),p(""),h(""),f([]),F.current&&(F.current.value="")}catch(e){L(e instanceof Error?e.message:"Failed to submit bug report"),w(!1)}finally{y(!1)}}},isDisabled:!n.trim()||!m.trim()||x}))))):null}},35159:(e,t,r)=>{r.d(t,{$:()=>c});var a=r(15380),n=r(44675),o=r(20905),l=r(56623),i=r(67960),s=r(29483);const c=()=>[new l.r("bg",(()=>(0,s.OB)().bgRpc.api.getBGLogs()),l.r.getLogsFromSessionStorageFallbackGetter(i.v.bgHistoryLogs)),new l.r("sidePanel",(()=>Promise.resolve((0,s.OB)().historyLogsService.getLogs())),l.r.getLogsFromSessionStorageFallbackGetter(i.v.sidePanelHistoryLogs)),new l.r("cs",(async()=>{const e=[],t=t=>{e.push(...t.option.logs.map((e=>({...e,loggerName:`${t.option.isIframeIntegration?`iframe.[${t.caller.frameId}].`:""}${e.loggerName}`}))))},r=(0,s.OB)().browserApi.message;return r.onRuntimeMessage.addListener(t),(0,s.OB)().bgRpc.api.sendToFocusTab({kind:a.B.Kind.requestCsLogsFromSidePanel}),await(0,n.gw)(o.E0),e.length||await(0,n.gw)(o.E0),r.onRuntimeMessage.removeListener(t),e.length?e:void 0}),l.r.getLogsFromSessionStorageFallbackGetter(i.v.csHistoryLogs))]},405:(e,t,r)=>{r.d(t,{g:()=>s});var a=r(92379),n=r(45550),o=r(82285),l=r(67283),i=r(42684);const s=a.forwardRef((function(e,t){const{label:r,className:s,helperMessage:c,errorMessage:u,isRequired:g,isOptional:d,placeholder:p,labelDisplay:m="visible",labelIndicatorForOptional:h,labelIndicatorForRequired:b,rows:f=3,resizable:x="on",minLength:y,maxLength:k,spellCheck:v}=e,E=a.useRef(null);a.useImperativeHandle(t,(()=>E.current));const{labelProps:w,inputProps:S}=(0,o.h)({...e,validationState:null!=u?"invalid":"valid",inputElementType:"textarea"},E),L={minLength:y,maxLength:k,spellCheck:v};return a.createElement("div",{className:"gds-text-area"},a.createElement(l.A,{label:r,labelDisplay:m,helperMessage:c,isRequired:g,isOptional:d,labelIndicatorForRequired:b,labelIndicatorForOptional:h,errorMessage:u,...w}),a.createElement("div",{className:"gds-text-area-container"},a.createElement("textarea",{className:(0,n.W)("gds-text-area-input",!0===S.disabled?"":`gds-text-area-resize-${x}`,s),...L,...S,placeholder:p,ref:E,rows:f,style:e.style})),a.createElement(i.f,{errorMessage:u}))}))}}]);