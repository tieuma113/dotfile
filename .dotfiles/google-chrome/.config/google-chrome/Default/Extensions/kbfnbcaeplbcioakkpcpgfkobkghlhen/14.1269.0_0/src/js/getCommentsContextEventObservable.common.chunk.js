(self.webpackChunk=self.webpackChunk||[]).push([[4266],{21243:(e,t,n)=>{n.d(t,{$2:()=>T,Cc:()=>I,EJ:()=>k,Hq:()=>g,P2:()=>P,QY:()=>c,Ue:()=>u,Xw:()=>f,aS:()=>l,fo:()=>x,k4:()=>v,mS:()=>L,tg:()=>$});var r=n(36807),s=n(71576),i=n(43789),o=n(39963);const a=n(72138);function l(e,t){if(e.length<=t)return e;if(t<=3)return"...";const n=Math.ceil((t-3)/2),r=Math.floor((t-3)/2);return`${e.substring(0,n)}...${e.substring(e.length-r,e.length)}`}function u(e){return e.replace(/[.,/#!$%^&*;:{}=\-_`~()\s]/g,"").toLowerCase()}var c,d,g;function f(e){var t;return(null===(t=/^(hwr:\/\/.+$|https?:\/\/[^/]+)/.exec(e))||void 0===t?void 0:t[1])||"Undetermined"}!function(e){e.getNumInsertedLetters=function(e){return e.ops.reduce(((e,t)=>s.s.isInsertString(t)?e+s.s.getInsertLength(t):e),0)},e.getNumDeletedLetters=function(e){const t=e.ops.filter((e=>s.s.isDelete(e)));let n=0;return t.forEach((e=>{s.s.isDelete(e)&&(n+=e.delete)})),n},e.getSummary=function(e,t){return t.ops.reduce(((t,n)=>{let{retained:r,retainedPrefix:i,deleted:o,inserted:a,maximalReplacement:l}=t.summary,u=t.pointer;return s.s.isRetain(n)&&(r=`${r}${e.substring(u,u+n.retain)}`,i=0===o.length&&0===a.length?`${i}${e.substring(u,u+n.retain)}`:i,l=l.length?`${l}${e.substring(t.pointer,t.pointer+n.retain)}`:l,u+=n.retain),s.s.isDelete(n)&&(o=`${o}${e.substring(u,u+n.delete)}`,u+=n.delete),s.s.isInsertString(n)&&(a=`${a}${n.insert}`,l=`${l}${n.insert}`),{pointer:u,summary:{retained:r,retainedPrefix:i,deleted:o,inserted:a,maximalReplacement:l}}}),{pointer:0,summary:{retained:"",retainedPrefix:"",deleted:"",inserted:"",maximalReplacement:""}}).summary},e.extractMaximalReplacementString=function(e,t){return t.ops.reduce(((t,n)=>(s.s.isInsertString(n)?t.text=`${t.text}${n.insert}`:s.s.isDelete(n)?t.originalTextPointer+=n.delete:s.s.isRetain(n)&&(t.text.length&&(t.text=`${t.text}${e.substring(t.originalTextPointer,t.originalTextPointer+n.retain)}`),t.originalTextPointer+=n.retain),t)),{text:"",originalTextPointer:0}).text||null},e.singleDelta=function(e,t){if(e===t)return new r.i([]);let n=0;const s=Math.min(e.length,t.length);for(;n<s&&e[n]===t[n];)n++;let i=0;for(;n+i<s&&t[t.length-i-1]===e[e.length-i-1];)i++;const o=e.length-(n+i),a=t.length-(n+i),l=[...n>0?[{retain:n}]:[],...o>0?[{delete:o}]:[],...a>0?[{insert:t.substring(n,n+a)}]:[]];return new r.i(l)},e.isNoTextChangesDelta=function(e){return e.ops.every((e=>s.s.isInsertString(e)?!e.insert.length:!s.s.isDelete(e)||!e.delete))}}(c||(c={})),function(e){e.isTextEqual=function(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;++n)if(e[n].character!=t[n].character)return!1;return!0},e.isContentEqual=function(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;++n)if(e[n].character!=t[n].character||e[n].sourceContentId!=t[n].sourceContentId||e[n].isSelfAuthored!=t[n].isSelfAuthored)return!1;return!0}}(d||(d={})),function(e){e.hasPerLetterTags=function(e){return e.isSelfAuthoredTags.length==e.text.length},e.toLoggableString=function(e){const t=l(e.text,40);return`CopiedContent [text length=${e.text.length}, has per letter tags=$hasPerLetterTags({sourcedContent)}, text=${t}]`},e.eq=function(e,t){if(e.length!==t.length)return!1;const n=e.slice().sort(((e,t)=>e.text.localeCompare(t.text)||e.sourceName.localeCompare(t.sourceName))),r=t.slice().sort(((e,t)=>e.text.localeCompare(t.text)||e.sourceName.localeCompare(t.sourceName)));return n.every(((e,t)=>e.text===r[t].text&&e.sourceName===r[t].sourceName))}}(g||(g={}));const h=new Set(["'","‘","’","＇","ߴ","ߵ"]),m=new Set(['"',"«","»","","“","”","„","‟","‹","›","❮","❯","❝","❞","❛","❜","〝","〞","⹂"]),p={a:new Set(["æ"]),s:new Set(["ß"]),"\n":new Set(["\v","\r","\v","\f"])};function v(e,t,n){var r,s,i,o;const a=c.getSummary(e,t);return".."===a.deleted&&"…"===a.inserted&&"."===(null===(r=n[0])||void 0===r?void 0:r.key)||"…"===a.deleted&&"..."===a.inserted&&""===(null===(s=n[0])||void 0===s?void 0:s.key)||"-"===a.deleted&&"–"===a.inserted&&"-"===(null===(i=n[0])||void 0===i?void 0:i.key)||"–"===a.deleted&&"--"===a.inserted&&""===(null===(o=n[0])||void 0===o?void 0:o.key)?1:0}function x(e,t){return!!e.length&&e.split("").every(((e,n)=>{var r;return void 0!==(null===(r=t[n])||void 0===r?void 0:r.key)&&function(e,t){var n;return 1===e.length&&1===t.length&&(e===t||0===e.localeCompare(t,void 0,{sensitivity:"case"})||Boolean(null===(n=p[e])||void 0===n?void 0:n.has(t))||"'"===e&&h.has(t)||'"'===e&&m.has(t))}(t[n].key,e)}))}function $(e){return e.map((e=>({...e,key:/\p{Letter}/u.test(e.key)?"#":e.key})))}function y(e,t){let n=0,r=t;for(;r<e.length&&"`"===e[r];)n++,r++;return n}function C(e){return e.replace(/^\s*\w+\s+/,"").replace(/(\s{0,3}>\s?)/g," ")}function S(e,t,n){let r=t;for(;r<e.length&&"\n"!==e[r];)if("`"===e[r]){const s=y(e,r),i=r+s;if(s>=n&&(i>=e.length||"\n"===e[i])){return{content:C(e.substring(t,r)),endPos:i}}r+=s}else r++;return null}function w(e,t){let n=t;for(;n<e.length&&(" "===e[n]||"\t"===e[n]);)n++;return n}function b(e,t,n){return t===n||"\n"===e[t-1]}function D(e,t){const n=y(e,t);if(n<3)return-1;const r=t+n;if(!function(e,t){const n=w(e,t);return n>=e.length||"\n"===e[n]}(e,r))return-1;const s=w(e,r);return s<e.length?s+1:s}function E(e,t){const n=function(e,t){let n=t;for(;n<e.length&&"\n"!==e[n];)n++;return n}(e,t);if(!(n<e.length&&"\n"===e[n]))return-1;return function(e,t){let n=t;for(;n<e.length;){if("`"!==e[n]||!b(e,n,t)){n++;continue}const r=D(e,n);if(-1!==r)return r;n++}return-1}(e,n+1)}function T(e){try{const t=function(e){const t=[];let n=0;for(;n<e.length;){if("`"===e[n]){const r=y(e,n);if(r>=3){const s=n+r,i=S(e,s,r);if(i){t.push(i.content),n=i.endPos;continue}const o=E(e,s);if(-1!==o){n=o;continue}}}t.push(e[n]),n++}return t.join("")}(e);return t.replace(/<[^>]*>/g,"").replace(/^(\s*)([*\-+]|\d+\.)\s+/gm,"").replace(/!\[(.*?)\][[(].*?[\])]/g,"$1").replace(/\[([^\]]*?)\][[(].*?[\])]/g,"$1").replace(/^(\n)?\s*#{1,6}\s*( (.+))? +#+$|^(\n)?\s*#{1,6}\s*( (.+))?$/gm,"$1$3$4$6").replace(/^[=-]{2,}\s*$/gm,"").replace(/^\s*[*\- ]+\s*$/gm,"").replace(/^(\s{0,3}>\s?)+/gm,"").replace(/([*_]+)(\S)(.*?\S)??\1/g,"$2$3").replace(/([*_]+)(\S)(.*?\S)??\1/g,"$2$3").replace(/`(.+?)`/g,"$1").replace(/~(.*?)~/g,"$1")}catch(t){return e}}function L(e,t){return a(e.replace(/\s|\p{C}/gu,""),t.replace(/\s|\p{C}/gu,""))}function k(e,t,n=7){for(let r=null==e?void 0:e.parentElement,s=0;r&&s<n;r=r.parentElement,s++)if(r.matches(t))return!0;return!1}function P(e,t,n){const r=(1-n)*t.length;return e.find((e=>{const n=T(e.text),s=i.zI.diffAsChanges(n,t);return!g.hasPerLetterTags(e)&&(s.amount<=r||0===L(n,t))}))||null}function U(e={},t){let n={...e};return t&&(n="object"==typeof t?{...n,...t}:{...n,data:t}),n}function I(e={}){const t=(0,o.Tb)().humanWritingReport;return{error:(n,r,s,i)=>{t.error(n,r,s,U(e,i))},warning:(n,r,s,i)=>{t.warning(n,r,s,U(e,i))},info:(n,r,s)=>{t.info(n,r,U(e,s))}}}},50829:(e,t,n)=>{n.r(t),n.d(t,{extractGDocsCommentContent:()=>C,getCommentsContextEventObservable:()=>D,getDiff:()=>w,recordChanged:()=>b,transformThreadsToSiblings:()=>$});var r,s=n(72314),i=n(36344),o=n(84714),a=n(50750),l=n(84308),u=n(90572),c=n(954),d=n(29416),g=n(20161),f=n(59179),h=n(89408),m=n(21243),p=n(45523);!function(e){e.Added="ADDED",e.Removed="REMOVED",e.Updated="UPDATED"}(r||(r={}));var v=n(1408),x=n(94728);function $(e,t,n){return e.map((e=>({docId:n,audience:{channelId:e.id},children:e.messages.map((e=>({audience:{channelId:e.id},authors:[{name:e.author.name,email:e.author.isCurrentSessionUser?t.email:e.author.email,currentSessionUser:e.author.isCurrentSessionUser}],delta:e.delta})))})))}function y(e){return Array.from(e).filter((e=>"classList"in e||!!e.parentElement)).some((e=>{var t;return"classList"in e?e.classList.contains("docos-anchoreddocoview")&&!e.classList.contains("docos-comments-pe")||e.classList.contains("docos-replyview"):null===(t=e.parentElement)||void 0===t?void 0:t.classList.contains("docos-replyview-body")}))}const C=e=>{const t=document.createElement("span");return t.innerHTML=(0,s.sanitize)(e),t.textContent||""};function S(e){return e.messages.some((e=>e.author.isCurrentSessionUser))}function w(e,t){const n=[],s=new Map(e.map((e=>[e.id,e]))),i=new Map(t.map((e=>[e.id,e])));for(const e of t){const t=[],i=s.get(e.id);if(!i){n.push({...e,messages:e.messages.map((e=>({...e,delta:m.QY.singleDelta("",e.content)}))),diffType:r.Added});continue}const o=new Map(i.messages.map((e=>[e.id,e]))),a=new Set(e.messages.map((e=>e.id)));e.messages.forEach((e=>{const n=e.content,r=o.get(e.id),s=r?r.content:"";s!==n&&t.push({...e,delta:m.QY.singleDelta(s,n)})})),i.messages.forEach((e=>{const n=e.content;a.has(e.id)||t.push({...e,delta:m.QY.singleDelta(n,"")})})),t.length&&n.push({...e,messages:t,diffType:r.Updated})}return e.forEach((e=>{i.has(e.id)||n.push({...e,messages:e.messages.map((e=>({...e,delta:m.QY.singleDelta(e.content,"")}))),diffType:r.Removed})})),n}function b(e){return y(e.addedNodes)||y(e.removedNodes)}function D(e,t,n){const r=e.querySelector(".kix-discussion-plugin"),s=(0,x.j)(e.URL)||"";if(!r)return i.E;let m=[];return p.x.createUnsafe(r,{childList:!0,subtree:!0}).pipe((0,u.h)((e=>Array.from(e).some((e=>b(e))))),(0,c.O)(void 0),(0,d.b)(2e3),(0,g.w)((e=>n?(0,a.D)(n().then((e=>{const t=e.filter(S).map((e=>function(e){return{...e,messages:e.messages.map((e=>({...e,content:C(e.content)}))).filter((e=>e.content.length))}}(e))),n=w(m,t);return m=t,n}))):(0,o.of)([]))),(0,u.h)((e=>!!e.length)),(0,g.w)((e=>(0,l.a)([(0,o.of)(e),t]))),(0,f.U)((([e,t])=>v.t.createDocContextUpdatedEvent({siblings:$(e,t,s)}))),(0,h.d)({bufferSize:1,refCount:!0}))}}}]);