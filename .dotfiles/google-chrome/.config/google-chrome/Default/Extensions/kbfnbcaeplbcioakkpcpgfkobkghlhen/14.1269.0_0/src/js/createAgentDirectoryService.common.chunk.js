(self.webpackChunk=self.webpackChunk||[]).push([[5196],{22925:(e,t,n)=>{n.r(t),n.d(t,{createAgentDirectoryService:()=>f});var r=n(98437),a=n(29483);class s{async fetchAgents(e){return(0,a.OB)().bgRpc.api.agentDirectoryFetchAgents(null!=e?e:"")}async listAgents(e){return(0,a.OB)().bgRpc.api.agentDirectoryListAgents(e)}async searchAgents(e,t,n){return(0,a.OB)().bgRpc.api.agentDirectorySearchAgents(e,t,n)}async createAgentInstance(e,t){return(0,a.OB)().bgRpc.api.agentDirectoryCreateAgentInstance(e,t)}async createDefaultAgentInstances(e,t){return(0,a.OB)().bgRpc.api.agentDirectoryCreateDefaultAgentInstances(e,t)}async editAgentInstance(e,t,n){return(0,a.OB)().bgRpc.api.agentDirectoryEditAgentInstance(e,t,n)}async addAgent(e){return(0,a.OB)().bgRpc.api.agentDirectoryAddAgent(e)}async removeAgentInstance(e,t){return(0,a.OB)().bgRpc.api.agentDirectoryRemoveAgentInstance(e,t)}async saveInstalledAgentsOrder(e,t,n){return(0,a.OB)().bgRpc.api.agentDirectorySaveInstalledAgentsOrder(e,t,n)}async listAgentInstances(e,t){return(0,a.OB)().bgRpc.api.agentDirectoryListAgentInstances(e,t)}async getUserAccountInfo(){return(0,a.OB)().bgRpc.api.agentDirectoryGetUserAccountInfo()}async getConnectionsInfoForUser(e){return(0,a.OB)().bgRpc.api.agentDirectoryGetConnectionsInfoForUser(e)}async getBrainTenantId(){return(0,a.OB)().bgRpc.api.agentDirectoryGetBrainTenantId()}async getExternalPackMetadata(e){return(0,a.OB)().bgRpc.api.agentDirectoryGetExternalPackMetadata(e)}async getAgentPackListing(e){return(0,a.OB)().bgRpc.api.agentDirectoryGetAgentPackListing(e)}async getAgentInstallationContext(e,t){return(0,a.OB)().bgRpc.api.agentDirectoryGetAgentInstallationContext(e,t)}async listIngestions(e,t){return(0,a.OB)().bgRpc.api.agentDirectoryListIngestions(e,t)}async getSimplifiedRootIngestionSummary(e,t){return(0,a.OB)().bgRpc.api.agentDirectoryGetSimplifiedRootIngestionSummary(e,t)}}var c=n(28898),i=n(16381);const o=["dev","prod"];var g=n(26389),l=n(19724),u=n(40594);const d=u.Y.create("getUserPersona");var y;function p(e){var t;if(!l.n.hasRole(e))return g.uj.Other;const n=null===(t=e.customFields)||void 0===t?void 0:t.frontend_role;switch(n){case y.School:return g.uj.Student;case y.Work:return g.uj.Professional;case y.OtherProjects:return g.uj.Other;default:return d.warn("Unexpected frontend_role value, defaulting to Other",{frontendRole:n,userId:e.id}),g.uj.Other}}!function(e){e.School="school",e.Work="work",e.OtherProjects="other projects"}(y||(y={}));var A=n(27982);const v={AcceptAllSuggestions:!1,AgentDirectory:!1,FirstPartyPackAgents:!1,GoBranding:!1,NativeInstallFlow:!1,SuggestionsSummary:!1,ContextSelectorRedesign:!1};class I{constructor(e={}){this.togglesState={...v,...e}}isFeatureEnabled(e){return this.togglesState[e]}}async function f(e){var t,n;const a=u.Y.create("createAgentDirectoryService"),g=e.experimentClient.isGateEnabled(A.K.AbilityToAddAgents);if(g)try{const u=new I({AgentDirectory:g,FirstPartyPackAgents:e.experimentClient.isGateEnabled(A.K.FirstPartyPackAgents),NativeInstallFlow:e.experimentClient.isGateEnabled(A.K.NativeInstallFlowForAgents)}),d=p(null!==(t=e.store.view("user").get())&&void 0!==t?t:l.n.defaultUser),y=function(e){var t,n,r,a;const s=(0,i.Um)(),{webBaseUrl:g}=s.codaAgentDirectory,l={agentSecurityUrl:"https://help.coda.io/hc/en-us/articles/39555832714381-Security-of-Packs-on-Coda",agentStoreUrl:`${g}/agents/`,reportAnIssue:"https://coda.io/form/Report-an-issue-with-an-agent_duLUVC5y4Td?agentID=",agentSetupUrl:`${g}/go/agent/setup/`},u=(0,c.O)().config.bundleInfo.env;if(!o.includes(u))return l;const d=null==e?void 0:e.urls;return d?{agentSecurityUrl:null!==(t=d.agentSecurityUrl)&&void 0!==t?t:l.agentSecurityUrl,agentStoreUrl:null!==(n=d.agentStoreUrl)&&void 0!==n?n:l.agentStoreUrl,reportAnIssue:null!==(r=d.reportAnIssue)&&void 0!==r?r:l.reportAnIssue,agentSetupUrl:null!==(a=d.agentSetupUrl)&&void 0!==a?a:l.agentSetupUrl}:l}(null===(n=e.store.view("dynamicConfig").get())||void 0===n?void 0:n.agentDirectory);a.info("Creating agent directory service",{userPersona:d,urls:y});const v=await r.PM.create({agentDirectory:new s,agentInstallationService:e.agentInstallationService,featureToggleProvider:u},{userPersona:d,urls:y});return a.info("Agent directory service created successfully"),v}catch(e){return void a.error("Error creating agent directory service",e)}else a.debug("Agent directory is not enabled")}}}]);