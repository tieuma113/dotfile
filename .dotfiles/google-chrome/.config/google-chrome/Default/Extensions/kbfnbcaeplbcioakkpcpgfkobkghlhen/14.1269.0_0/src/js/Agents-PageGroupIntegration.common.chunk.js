(self.webpackChunk=self.webpackChunk||[]).push([[128],{71206:(e,t,i)=>{i.d(t,{K:()=>s});class s{constructor(){this._pendingRevision=0,this._finishedRevisions={regular:-1,plagiarism:-1,ai_detector:-1,writing_expert_check:-1,ai_studio:-1,audience_adapt:-1},this._wasChecked={regular:!1,plagiarism:!1,ai_detector:!1,writing_expert_check:!1,ai_studio:!1,audience_adapt:!1},this.reset()}getCheckState(e){return this._pendingRevision>this._finishedRevisions[e]?this._wasChecked[e]?"checking":"full":"idle"}getRevisionCheckState(){return this.getCheckState("regular")}getAsyncChecksState(){return{plagiarism:this.getCheckState("plagiarism"),ai_detector:this.getCheckState("ai_detector"),writing_expert_check:this.getCheckState("writing_expert_check"),ai_studio:this.getCheckState("ai_studio"),audience_adapt:this.getCheckState("audience_adapt")}}stage(e){this._pendingRevision=Math.max(this._pendingRevision,e)}finishRevision(e){this._finishedRevisions.regular=Math.max(this._finishedRevisions.regular,e),this._wasChecked.regular=!0}finishAsyncCheck(e,t){this._finishedRevisions[e]=Math.max(this._finishedRevisions[e],t),this._wasChecked[e]=!0}reset(){this._pendingRevision=0,this._finishedRevisions={regular:-1,plagiarism:-1,ai_detector:-1,writing_expert_check:-1,ai_studio:-1,audience_adapt:-1}}}},12898:(e,t,i)=>{i.d(t,{Kf:()=>p.K,TJ:()=>d.T,D8:()=>d.D,kX:()=>g});var s=i(64152),r=i(81484),n=Object.defineProperty,o=Object.defineProperties,a=Object.getOwnPropertyDescriptors,c=Object.getOwnPropertySymbols,h=Object.prototype.hasOwnProperty,u=Object.prototype.propertyIsEnumerable,l=(e,t,i)=>t in e?n(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i;function g(e){return(0,s.t)(((e,t)=>o(e,a(t)))(((e,t)=>{for(var i in t||(t={}))h.call(t,i)&&l(e,i,t[i]);if(c)for(var i of c(t))u.call(t,i)&&l(e,i,t[i]);return e})({},e),{schema:e.protocol,factories:r.i}))}var d=i(88257);if(5526!=i.j)var p=i(71206)},68822:(e,t,i)=>{i.d(t,{EP:()=>a,PJ:()=>h,W5:()=>o,YG:()=>c});var s=i(12518),r=i(64443),n=i(32103);class o extends n.sH{constructor(e){super(Boolean(e)?e:"Timeout"),this.name="TimeoutError"}static isTimeoutError(e){return e instanceof o}}class a extends n.sH{constructor(e){super(Boolean(e)?e:"Dropped"),this.name="DroppedError"}static isDroppedError(e){return e instanceof a}}class c extends n.sH{constructor(e){super(Boolean(e)?e:"Not Connected to WS"),this.name="NotConnectedError"}static isNotConnectedError(e){return e instanceof c}}class h{constructor(e=5e3,t="",i=new o){this._timeout=e,this.name=t,this._timeoutError=i,this._requests=new Map,this._log=r.C8.Logging.getLogger("coreclients.valueRequester"+(t.length>0?"."+t:""))}watchRequest(e,t=this._timeout){return this._startRequestWatch(e,t)}hasRequest(e){return this._requests.has(e)}onValue(e,t){this._stopRequest(e,s.F2(t))}onError(e,t){this._log.trace(`onError:(${e})`),this._stopRequest(e,s.t$(t))}clear(e){this._log.trace("clearing request watches: "+e),this._requests.forEach(((t,i)=>{this.onError(i,new a(`command (${this.name}) can not be executed, reason: ${e}`))}))}_startRequestWatch(e,t){this._log.debug(`Starting request watch: ${e}`),(0,n.kG)(!this._requests.has(e),"must not start watch for same request twice, request already watched: "+e);const i={};return i.promise=new Promise((e=>{i.resolve=e})),i.timer=self.setTimeout((()=>this._stopRequest(e,s.t$(this._timeoutError))),t),this._requests.set(e,i),i.promise}_stopRequest(e,t){this._log.trace(`_stopRequest: stopping request watch: ${e}`,t);const i=this._requests.get(e);void 0===i?this._log.warn("Got result for unknown request or request has already expired.",{id:e,result:t}):(clearTimeout(i.timer),i.resolve(t),this._requests.delete(e))}}},77784:(e,t,i)=>{function s(){return"agents/@impl"}function r(e){return`agents/${e}`}function n(e,...t){return o(e,...t)}function o(e,...t){return`agents/@impl/${e}${u(t)}`}function a(e,t,...i){return c(e,t,...i)}function c(e,t,...i){return`${r(e)}/${t}${u(i)}`}function h(e,...t){return`agents/${e}${u(t)}`}function u(e){const t=e.filter(Boolean).join("/");return t?`/${t}`:""}i.d(t,{EZ:()=>o,Lu:()=>r,Yx:()=>c,e7:()=>s,rL:()=>h,wS:()=>n,yp:()=>a})},44361:(e,t,i)=>{i.d(t,{F:()=>r});var s=i(23162);class r{constructor(e){this._experimentClient=e}isAssigned(e,...t){if(e instanceof s.Cc)return this._experimentClient.isGateEnabled(e);const i=this._experimentClient.getTreatment(e);return null!==i&&i!==s.q4&&t.includes(i)}getTreatment(e){const t=this._experimentClient.getTreatment(e);return t===s.q4?null:t}peekExperiment(e,...t){const i=this._experimentClient.peekTreatment(e);return null!==i&&i!==s.q4&&t.includes(i)}}},97270:(e,t,i)=>{i.d(t,{Q:()=>a});var s=i(90023),r=i(12518),n=i(68822),o=i(40594);class a{constructor(e,t,i){this._telemetry=i;const a=o.Y.create("AgentsTrackingServiceProvider");this._trackingService={trackEvent:(i,o)=>{e.sendFeedback({eventName:i,eventData:JSON.stringify(o),agentId:t})().then((e=>(0,s.zG)(e,r.pF((e=>{throw e}))))).then((e=>{a.debug("Tracking event sent successfully",{event:i,detail:o,response:e})})).catch((e=>{e instanceof n.W5?a.debug("Didn't receive the success response for tracking request on time (it doesn't necessarily mean that the event was not tracked)",{event:i,detail:o,error:e}):(this._telemetry.warn("Tracking request failed",e,{event:i,detail:o,agentId:t}),a.warn("Tracking request failed",e,{event:i,detail:o}))}))}}}getTrackingService(){return this._trackingService}}},33863:(e,t,i)=>{i.d(t,{$:()=>o});var s=i(90023),r=i(12518),n=i(40594);class o{constructor(e,t){this._actions=e,this._telemetry=t,this._log=n.Y.create("AgentsUphookHubClient")}async getUphookConfig(e){try{const t=await this._actions.getConfiguration(e);return(0,s.zG)(t,r.g_((e=>{throw e}),(e=>e)))}catch(t){throw this._telemetry.error(`Failed to get uphook config for ${e}`,t),this._log.warn(`Failed to get uphook config for ${e}`,t),t}}async trackUphookEvent(e,t){try{const i=await this._actions.trackConfiguration(t,e);(0,s.zG)(i,r.g_((e=>{throw e}),(()=>{})))}catch(i){const s=`Failed to track uphook event for ${(null==e?void 0:e.upgradeHookSlot)||"unknown"} uphook with event kind ${t}`;throw this._telemetry.error(s,i),this._log.warn(s,i),i}}}},85933:(e,t,i)=>{i.d(t,{u:()=>o});var s=i(12518),r=i(77632),n=i(25466);function o(e){return new r.f(a(e),new c)}const a=e=>{const t=new Set;return"edge"!==e.browser&&"msie"!==e.browser&&t.add(n.L.Flag.supportsSVGDominantBaseline),{has:e=>t.has(e)}};class c{constructor(){this.openUrl=e=>(0,s.Y3)((()=>{document.location.href=e.toString()}),s.KC),this.openPopup=e=>(0,s.Y3)((()=>{const t=self.open(e.toString(),"_blank","noopener,noreferrer");t&&(t.opener=null)}),s.KC)}}},39146:(e,t,i)=>{i.r(t),i.d(t,{AgentsPageGroupIntegration:()=>p});var s=i(12898),r=i(15339),n=i(40594),o=i(77784),a=i(44361),c=i(97270),h=i(33863),u=i(85933),l=i(24196),g=i(40795),d=i(63534);class p{constructor(e){this._disposables=new AsyncDisposableStack,this._logger=n.Y.create("Agents.PageGroupIntegration"),this._platformInfo=r.W.detect(),this._environment=(0,u.u)(this._platformInfo),this._pageLoadActivationsRun=!1,this._telemetry=e.telemetry,this._textActionsService=e.textActionsService,this._agentGenericService=e.agentGenericService,this._contextService=e.contextService,this._experimentClient=e.experimentClient,this._messageBusClient=e.messageBusClient,this._platformBus=this._messageBusClient.platformBus,this._agentDefinitions=(0,g.c)(e.experimentClient),this._experimentationService=new a.F(e.experimentClient),this._uphookHubClient=(0,l.sI)(e.experimentClient)?new h.$(e.actions,this._telemetry):{getUphookConfig:()=>Promise.resolve(void 0),trackUphookEvent:()=>Promise.resolve()},this._userService={user:e.user.view((e=>({id:e.id,firstName:e.firstName,email:e.email,free:!e.premium,anonymous:e.anonymous})))},this._activePanelAgentId=this._disposables.use(this._platformBus.state.activePanelAgentId.view(null))}async runPageLoadActivations(){if(this._pageLoadActivationsRun)return this._logger.warn("Page load activations already run, skipping"),[];if(!(0,l.w4)(this._experimentClient))return this._logger.debug("Agents feature not enabled, skipping page load activations"),[];this._pageLoadActivationsRun=!0,this._logger.info("Running page load activations for all agents");const e=[];for(const t of this._agentDefinitions){if(!t.integrations.pageLoadActivate)continue;this._logger.debug(`Running page load activation for ${t.id}`);const i=this._messageBusClient.createPort({name:(0,o.yp)(t.id,"page-load","page")});try{const r=new c.Q(this._agentGenericService,t.id,this._telemetry),n=t.integrations.pageLoadActivate({bus:this._disposables.use((0,s.kX)({port:i,clientId:(0,o.Yx)(t.id,"page-load","page"),keyPrefix:(0,o.Lu)(t.id),protocol:t.protocol})),navigation:{isPanelOpen:this._activePanelAgentId.view((e=>e===t.id))},experimentation:this._experimentationService,environment:this._environment,platformInfo:this._platformInfo,userService:this._userService,uphookHubClient:this._uphookHubClient,trackingServiceProvider:r,textActionsService:this._textActionsService,contextService:this._contextService}).then((()=>(this._logger.debug(`Page load activation completed for ${t.id}`),{agentId:t.id}))).catch((e=>{throw this._logger.error(`Failed to run pageLoadActivate for agent ${t.id}`,e),this._telemetry.error("Failed to run pageLoadActivate for agent",e,{agentId:t.id}),e}));this._disposables.use((0,d.T0)(n.catch((()=>null)))),e.push(n)}catch(e){this._logger.error(`pageLoadActivate error for agent ${t.id}`,e),this._telemetry.error("pageLoadActivate error for agent",e,{agentId:t.id})}}return(await Promise.allSettled(e)).filter((e=>"fulfilled"===e.status)).map((e=>e.value))}async[Symbol.asyncDispose](){await this._disposables.disposeAsync()}}},63534:(e,t,i)=>{function s(e){return{[Symbol.asyncDispose]:async()=>{if(!e)return;const t=await e;t&&(!function(e){return Symbol.dispose in e}(t)?function(e){return Symbol.asyncDispose in e}(t)&&await t[Symbol.asyncDispose]():t[Symbol.dispose]())}}}i.d(t,{T0:()=>s})}}]);