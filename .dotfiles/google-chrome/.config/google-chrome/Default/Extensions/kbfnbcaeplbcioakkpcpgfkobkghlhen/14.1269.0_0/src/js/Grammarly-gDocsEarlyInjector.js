!function(){function e(e){return`grammarly-${e}`}var t,n;!function(t){const n=e("desktop-integration");t.inject=function(t=document.documentElement,o={}){var r,i;const c=`\n      div.${n} {\n        position: absolute;\n        width: 1px;\n        height: 1px;\n        padding: 0;\n        margin: -1px;\n        overflow: hidden;\n        clip: rect(0, 0, 0, 0);\n        white-space: nowrap;\n        border: 0;\n        -moz-user-select: none;\n        -webkit-user-select: none;\n        -ms-user-select:none;\n        user-select:none;\n      }\n\n      div.${n}:before {\n        content: attr(data-content);\n      }\n    `,a=document.createElement("style");a.textContent=c;const s=document.createElement("div");s.setAttribute("aria-label",e("integration")),s.setAttribute("role","group"),s.setAttribute("tabindex","-1"),s.setAttribute("class",n);const l=document.createElement(n);return o.setPresentationRoleOnHost&&l.setAttribute("role","presentation"),l.attachShadow({mode:"open"}),l.setAttribute(`data-grammarly-${"shadow-root"}`,"true"),null===(r=l.shadowRoot)||void 0===r||r.appendChild(a),null===(i=l.shadowRoot)||void 0===i||i.appendChild(s),t.appendChild(l),{activate:({isActive:e,isUserDisabled:t,mode:n})=>{null==s||s.setAttribute("data-content",JSON.stringify(n?{mode:n,isActive:e,isUserDisabled:t}:{isActive:e}))},remove:()=>{var e;null===(e=null==l?void 0:l.parentNode)||void 0===e||e.removeChild(l)}}},t.isInjected=function(){return!!document.querySelector(n)}}(t||(t={})),function(e){e.background="message:to-priv",e.sidePanelCloseStatus="side-panel-close-status",e.messageBusPort="message-bus-port"}(n||(n={}));var o,r;function i(){return(65536*(1+Math.random())|0).toString(16).substring(1)}!function(e){e.OpenSubscriptionDialog="OPEN_SUBSCRIPTION_DIALOG",e.SetUserInfo="SET_USER_INFO",e.ReloadBgPage="RELOAD_BACKGROUND_PAGE",e.NetworkServiceRequest="NETWORK_SERVICE_REQUEST",e.NetworkServiceResponse="NETWORK_SERVICE_RESPONSE"}(o||(o={})),function(e){e[e.success=0]="success",e[e.successWithEmpty=1]="successWithEmpty",e[e.alreadyMigrated=2]="alreadyMigrated"}(r||(r={}));var c;!function(e){e.syncDevtoolsInitialStateWithTab="syncDevtoolsInitialStateWithTab"}(c||(c={}));class a{constructor(e,t){this.port=e.runtime.connect({name:t})}onMessage(e){this.port.onMessage.addListener(e)}onDisconnect(e){this.port.onDisconnect.addListener(e)}postMessage(e){this.port.postMessage(e)}}!function(e,n,o,r=!1){r&&function(){const e=document.createElement("script");e.textContent="\n  (function () {\n    try {\n      if (\n        window.GR_gdocs_connector_patched === true\n      ) {\n        return\n      }\n\n      if (window._createKixApplication) {\n        window.GR_gdocs_connector_err = new Error('GDocs was already initialized, too late to patch.')\n      }\n\n      let originalCreateKixApplication = window._createKixApplication;\n      let wrappedCreateKixApplication;\n      // Patch before any modules load\n      const descriptor = {\n        set: function (fn) {\n          originalCreateKixApplication = fn\n          wrappedCreateKixApplication = function (...args) {\n            try {\n              const result = originalCreateKixApplication.apply(this, args)\n              window.GR_gdocs_connector = result\n              return result\n            } catch (err) {\n              window.GR_gdocs_connector_err = err\n              // Re-throw the original error, as we should not suppress the original behavior\n              throw err\n            }\n          }\n        },\n        get: function () {\n          return wrappedCreateKixApplication || originalCreateKixApplication\n        },\n        configurable: true,\n        enumerable: true\n      }\n\n      // Apply to all possible global contexts\n      Object.defineProperty(window, '_createKixApplication', descriptor)\n      window.GR_gdocs_connector_patched = true\n    } catch (err) {\n      window.GR_gdocs_connector_err = err\n    }\n  })()\n  ";const t=document.querySelector("script");t?t.parentNode.insertBefore(e,t):(document.head||document.documentElement).appendChild(e)}(),o({level:"INFO",logger:"gDocsEarlyInjector.startInitialization"});try{!function(e,t,n,o=document,r=!1,i,c){const a=e,s=o.documentElement;if(r){const e=o.createElement("link");e.href=a,e.rel="preload",e.as="script",e.onload=()=>{e.remove()},s.prepend(e)}const l=o.createElement("script");l.async=!1,l.defer=!1,l.src=a,l.type="text/javascript",t&&l.setAttribute("data-ext-id",t),n&&l.setAttribute("data-ext-version",n),l.onload=()=>{null==i||i(),l.remove()},l.onerror=()=>{null==c||c()},s.prepend(l)}(n("Grammarly-gDocsEarlyInjectedCs.js"),e,void 0,void 0,!0,(()=>o({level:"INFO",logger:"gDocsEarlyInjector.injected",femetricsExtra:{script:"gDocsEarlyInjectedCs"}})),(()=>o({level:"ERROR",logger:"gDocsEarlyInjector.injectError",femetricsExtra:{script:"gDocsEarlyInjectedCs"}}))),t.inject().activate({isActive:!0}),o({level:"INFO",logger:"gDocsEarlyInjector.finishInitialization"})}catch(e){o({level:"ERROR",logger:"gDocsEarlyInjector.failInitialization",error:e})}}(chrome.runtime.id,(e=>chrome.runtime.getURL(`src/js/${e}`)),function(e){const t=e(n.background);return function(e){t.postMessage({type:"cs-to-bg-rpc-1557421403805",callid:i()+i()+"-"+i()+"-"+i()+"-"+i()+"-"+i()+i()+i(),content:{data:{args:["tracking/RPC",["sendFelogEvent",Object.assign({sendToFemetrics:!0},e)]],method:"trackCall"}}})}}((e=>new a(chrome,e))))}();