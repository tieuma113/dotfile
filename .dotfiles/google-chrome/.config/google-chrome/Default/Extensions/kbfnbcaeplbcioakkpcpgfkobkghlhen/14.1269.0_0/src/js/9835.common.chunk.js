(self.webpackChunk=self.webpackChunk||[]).push([[9835],{89835:(e,s,t)=>{t.r(s),t.d(s,{activate:()=>y});var n=t(32073),r=t(84714),o=t(90572),i=t(32103),a=t(90023),c=t(58303),p=t(45676),u=t(67839),d=t(12518),l=t(88012),b=t(18519),v=t(66878),h=t(36344);class w{constructor(e){this._agentGenericService=e,this._subs=new l.w.Keeper,this._lastPendingRequests=new Map}cancelLastPendingRequest(e){const s=this._lastPendingRequests.get(e);void 0!==s&&(s.unsubscribe(),this._lastPendingRequests.delete(e))}runRequest(e,s,t,n){return this._agentGenericService.requestWithStreaming({agentId:u.Gq,commandId:e,payload:s})().then((e=>(0,a.zG)(e,d.pF((e=>{throw e}))))).then((s=>new Promise(((r,o)=>{const i=(0,a.zG)(t,c.g_((()=>s),(e=>s.pipe(b.V(e),v.K((e=>(b.W,o(e),h.E))))))).subscribe((e=>{(0,a.zG)(e,d.KB((e=>{o(e)}),(e=>{n(e),"final"===e.kind&&r()})))}));this._subs.push(i),this._lastPendingRequests.set(e,i)}))))}dispose(){this._subs.dispose()}}var g=t(50999),f=t(33672),x=t(74170),E=(e,s)=>(s=Symbol[e])?s:Symbol.for("Symbol."+e),k=e=>{throw TypeError(e)},m=(e,s,t)=>new Promise(((n,r)=>{var o=e=>{try{a(t.next(e))}catch(e){r(e)}},i=e=>{try{a(t.throw(e))}catch(e){r(e)}},a=e=>e.done?n(e.value):Promise.resolve(e.value).then(o,i);a((t=t.apply(e,s)).next())}));const y=e=>m(void 0,[e],(function*({bus:e,document:s,agentGenericService:t,pushedContentService:d,capiEvents:l,capiCheckingState:b,capiConnectionStatus:v,experimentation:h,navigation:y,trackingServiceProvider:A}){var S=[];try{const R=((e,s,t)=>{var n;return null!=s?("object"!=typeof s&&"function"!=typeof s&&k("Object expected"),t&&(n=s[E("asyncDispose")]),void 0===n&&(n=s[E("dispose")]),"function"!=typeof n&&k("Object not disposable"),e.push([t,n,s])):t&&e.push([t]),s})(S,new DisposableStack),U=R.adopt(new n.w0,(e=>e.unsubscribe())),P=R.use(e.state.agentState.create(s.id,f.b6)),F=R.use(e.state.followUpTopics.create(s.id,[])),B=R.use(e.state.capiSessionId.create(s.id,null)),T=R.use(e.state.textInfo.create(s.id,{wordsCount:0,charsCount:0})),_=new w(t),q=R.adopt(new u.XC(d,{events:l},v.view((e=>"connected"===e.kind)),A,_,T,{setFocusMode:a.Q1,focusModeDecorationType:r.of(c.YP),removeAgentDecorations:a.Q1},g.p,{followUpActions:h.isAssigned(x.ExpertReviewFollowUpActions),followUpActionsFreeformInput:h.isAssigned(x.ExpertReviewFollowUpActionsFreeform),shouldAutoScrollToFirstVBar:h.isAssigned(x.ExpertReviewAutoScrollToFirstVBar),usePushedContentRebasing:h.isAssigned(x.ExpertReviewRebase)},y.isPanelOpen,y.isPanelOpen),(e=>e[Symbol.dispose]()));return U.add(q.state.subscribe((e=>P.set(e)))),U.add(q.followUpTopics.subscribe((e=>{F.set(e)}))),U.add(l.pipe(o.h(p.hX.is("session_started"))).subscribe((e=>B.set(e.sessionUuid)))),U.add(b.textInfo.subscribe((e=>(0,a.zG)(c.ij(e),c.UI((e=>({wordsCount:e.wordCount,charsCount:e.charCount}))),c.fS((()=>({wordsCount:0,charsCount:0}))),T.set)))),U.add(e.events.trackingEvent.view(s.id).subscribe((e=>q.context.tracking.trackEvent(e.event,e.detail)))),U.add(e.events.panelUIAction.view(s.id).subscribe((t=>m(void 0,null,(function*(){switch(t.kind){case"selectExpert":q.internalActions.selectExpert(t.expertName);break;case"deselectExpert":q.internalActions.deselectExpert();break;case"removeExpert":q.internalActions.removeExpert(t.expertName);break;case"goToChooseExperts":q.internalActions.goToChooseExperts();break;case"goBackFromChooseExperts":q.internalActions.goBackFromChooseExperts();break;case"reloadAgent":q.internalActions.reloadAgent();break;case"addExpertsByTopic":yield q.internalActions.addExpertsByTopic(t.topic),e.events.panelUIResponse.emit(s.id,{kind:"addExpertsByTopicResponse",topic:t.topic});break;case"addExpertsByUserInput":yield q.internalActions.addExpertsByUserInput(t.userInput),e.events.panelUIResponse.emit(s.id,{kind:"addExpertsByUserInputResponse",userInput:t.userInput});break;case"requestFollowUpSuggestions":q.internalActions.requestFollowUpSuggestions();break;default:(0,i.L0)(t)}}))))),R.move()}catch(e){var C=e,I=!0}finally{((e,s,t)=>{var n="function"==typeof SuppressedError?SuppressedError:function(e,s,t,n){return(n=Error(t)).name="SuppressedError",n.error=e,n.suppressed=s,n},r=e=>s=t?new n(e,s,"An error was suppressed during disposal"):(t=!0,e),o=n=>{for(;n=e.pop();)try{var i=n[1]&&n[1].call(n[2]);if(n[0])return Promise.resolve(i).then(o,(e=>(r(e),o())))}catch(e){r(e)}if(t)throw s};o()})(S,C,I)}}))},66878:(e,s,t)=>{t.d(s,{K:()=>i});var n=t(16537),r=t(96643),o=t(19064);function i(e){return(0,o.e)((function(s,t){var o,a=null,c=!1;a=s.subscribe((0,r.x)(t,void 0,void 0,(function(r){o=(0,n.Xf)(e(r,i(e)(s))),a?(a.unsubscribe(),a=null,o.subscribe(t)):c=!0}))),c&&(a.unsubscribe(),a=null,o.subscribe(t))}))}}}]);