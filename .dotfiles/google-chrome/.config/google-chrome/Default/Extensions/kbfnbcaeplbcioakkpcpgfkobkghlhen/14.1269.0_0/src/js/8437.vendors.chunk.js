/*! For license information please see 8437.vendors.chunk.js.LICENSE.txt */
(self.webpackChunk=self.webpackChunk||[]).push([[8437],{4246:(t,e,n)=>{var r=n(92379),a=Symbol.for("react.element"),i=Symbol.for("react.fragment"),s=Object.prototype.hasOwnProperty,o=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(t,e,n){var r,i={},l=null,d=null;for(r in void 0!==n&&(l=""+n),void 0!==e.key&&(l=""+e.key),void 0!==e.ref&&(d=e.ref),e)s.call(e,r)&&!c.hasOwnProperty(r)&&(i[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps)void 0===i[r]&&(i[r]=e[r]);return{$$typeof:a,type:t,key:l,ref:d,props:i,_owner:o.current}}e.Fragment=i,e.jsx=l,e.jsxs=l},651:(t,e,n)=>{t.exports=n(4246)},96456:(t,e,n)=>{n.d(e,{xt:()=>s});var r=n(26389);const a=new Set(Object.values(r.Bm).filter((t=>"number"==typeof t))),i={aiDetector:(0,r.QZ)(r.Bm.GrammarlyAiDetector.toString()),AIGrader:(0,r.QZ)(r.Bm.GrammarlyAiGrader.toString()),chat:(0,r.QZ)(r.Bm.SuperhumanGo.toString()),expertPanel:(0,r.QZ)(r.Bm.GrammarlyExpertReview.toString()),humanizer:(0,r.QZ)(r.Bm.GrammarlyHumanizer.toString()),plagiarismChecker:(0,r.QZ)(r.Bm.GrammarlyPlagiarismChecker.toString()),legacyProofreader:(0,r.QZ)(r.Bm.GrammarlyProofreader.toString()),paraphraser:(0,r.QZ)(r.Bm.GrammarlyParaphraser.toString()),readerReactions:(0,r.QZ)(r.Bm.GrammarlyReaderReactions.toString()),translate:(0,r.QZ)(r.Bm.GrammarlyReaderTranslate.toString()),comprehension:(0,r.QZ)(r.Bm.GrammarlyReaderComprehension.toString())};Object.fromEntries(Object.entries(i).map((t=>{let[e,n]=t;return[n,e]})));function s(t){if(!(0,r.kq)(t))return!1;try{const e=(0,r.Oo)(t);return a.has(e)}catch{return!1}}},98437:(t,e,n)=>{n.d(e,{PM:()=>f});var r=n(62220),a=n(26389),i=n(50208),s=n(96456),o=n(34549),c=n(65178),l=n(651),d=n(92379),h=n(63978),u=n(22980),g=n(10153);const m=class t{constructor(t,e,n){this.tenantId=t,this.provider=e,this.eventEmitter=n,this.localOrder=[],this.syncTimer=null}updateLocalOrderFromInstances(t){this.localOrder=[...t]}getCurrentOrder(){return[...this.localOrder]}getCurrentOrderAgentIds(){return this.localOrder.map((t=>t.agentId))}async reorderWithOptimisticUpdate(t,e){if(!this.localOrder.find((e=>e.agentInstanceId===t.agentInstanceId)))throw new Error(`Cannot reorder: Agent instance with id '${t.agentInstanceId}' not found`);const n=[...this.localOrder];try{this.updateLocalOrder(t,e),this.emit(this.localOrder),await this.provider.saveInstalledAgentsOrder(this.tenantId,t.agentInstanceId,null==e?void 0:e.agentInstanceId),this.scheduleDeferredSync()}catch(t){throw this.localOrder=n,this.emit(n),t}}updateLocalOrder(t,e){const n=this.localOrder.findIndex((e=>e.agentInstanceId===t.agentInstanceId));if(-1===n)return;this.localOrder.splice(n,1);let r=this.localOrder.length;if(e){const t=this.localOrder.findIndex((t=>t.agentInstanceId===e.agentInstanceId));-1!==t&&(r=t)}this.localOrder.splice(r,0,t)}scheduleDeferredSync(){this.syncTimer&&clearTimeout(this.syncTimer),this.syncTimer=setTimeout((()=>{this.syncOrderFromBackend()}),t.SYNC_DEBOUNCE_DELAY_MS)}async syncOrderFromBackend(){try{const t=[...(await this.provider.listAgentInstances(this.tenantId)).agentInstances];this.arraysEqual(this.localOrder,t)||(this.localOrder=t,this.emit(t))}catch(t){console.error("Error syncing agent order from backend:",t)}}emit(t){this.eventEmitter.emit("installedAgentsOrderChanged",{agentIds:t.map((t=>t.agentId))})}arraysEqual(t,e){if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n].agentInstanceId!==e[n].agentInstanceId)return!1;return!0}dispose(){this.syncTimer&&(clearTimeout(this.syncTimer),this.syncTimer=null)}};m.SYNC_DEBOUNCE_DELAY_MS=2e3;let p=m;const y=(0,d.lazy)((()=>Promise.all([n.e(9784),n.e(5175),n.e(6333),n.e(1088),n.e(3486),n.e(5295),n.e(6155),n.e(1990),n.e(2168),n.e(9262),n.e(2572),n.e(2528)]).then(n.bind(n,2919)).then((t=>({default:t.ThirdPartyAgent})))));function I(t){return![(0,a.QZ)(a.Bm.SuperhumanGo.toString())].includes(t.id)}class f{constructor(t,e){this.eventEmitter=new r.v,this.isInitialized=!1,this.instanceIdToAgentIdMap={},this.tenantId=null,this.reorderingService=null,this.hasAttemptedDefaultCreation=!1,this.agentDirectoryProvider=t.agentDirectory,this.agentInstallationService=t.agentInstallationService,this.featureToggleProvider=t.featureToggleProvider,this.agentInstanceMap={},this.isInitialized=!1,this.userPersona=e.userPersona,this.urls=Object.freeze({...e.urls})}async initializeState(){const t=await this.agentDirectoryProvider.getBrainTenantId();this.tenantId=t.brainTenantId??null,this.tenantId&&(this.reorderingService=new p(this.tenantId,this.agentDirectoryProvider,this.eventEmitter)),await this.listAgentInstances(),this.shouldCreateDefaultAgents()&&(this.hasAttemptedDefaultCreation=!0,await this.createDefaultAgentInstances(this.userPersona)),this.agentInstallationService&&this.agentInstallationService.addEventListener("agentInstallationCompleted",(async({packId:t})=>{try{const e=(0,a.QZ)(t);await this.refreshAgentInstances(),await this.requestDeeplink({viewType:a.Gk.AgentChat,agentId:e})}catch(e){console.error("Error in agentInstallationCompleted handler:",t,e)}})),this.isInitialized=!0}shouldCreateDefaultAgents(){if(this.featureToggleProvider&&!this.featureToggleProvider.isFeatureEnabled(a.oJ.FirstPartyPackAgents)||this.hasAttemptedDefaultCreation||null===this.tenantId)return!1;const t=this.getFirstPartyAgentIds();return 0===t.length?0===Object.keys(this.agentInstanceMap).length:t.filter((t=>!this.isAgentInstalled(t))).length===t.length}applyCreatorTransformation(t){return t.creator===i.e.CODA&&this.featureToggleProvider?(0,s.xt)(t.id)?t.id===(0,a.QZ)(a.Bm.SuperhumanGo.toString())?this.featureToggleProvider.isFeatureEnabled(a.oJ.GoBranding)?{...t,creator:i.e.SUPERHUMAN,name:"Go"}:t:this.featureToggleProvider.isFeatureEnabled(a.oJ.FirstPartyPackAgents)?{...t,creator:i.e.GRAMMARLY}:t:this.featureToggleProvider.isFeatureEnabled(a.oJ.GoBranding)?{...t,creator:i.e.SUPERHUMAN}:t:t}getFirstPartyAgentIds(){return[(0,a.QZ)(a.Bm.GrammarlyProofreader.toString()),(0,a.QZ)(a.Bm.GrammarlyPlagiarismChecker.toString()),(0,a.QZ)(a.Bm.GrammarlyReaderTranslate.toString()),(0,a.QZ)(a.Bm.GrammarlyReaderComprehension.toString()),(0,a.QZ)(a.Bm.GrammarlyAiDetector.toString()),(0,a.QZ)(a.Bm.GrammarlyAiGrader.toString()),(0,a.QZ)(a.Bm.GrammarlyCitationFinder.toString()),(0,a.QZ)(a.Bm.GrammarlyParaphraser.toString()),(0,a.QZ)(a.Bm.GrammarlyReaderReactions.toString()),(0,a.QZ)(a.Bm.GrammarlyHumanizer.toString()),(0,a.QZ)(a.Bm.GrammarlyExpertReview.toString())]}static async create(t,e){try{const n=new f(t,e);return await n.initializeState(),n}catch(t){throw new a.MY(a.MU.InitializationFailed,"Service initialization failed during state setup",t instanceof Error?t:new Error(String(t)))}}async listAgents(t={},e){var n,r;null!=(n=this.featureToggleProvider)&&n.isFeatureEnabled(a.oJ.SetGoEntrypoint)&&(t.entrypoint=a.ZR.Go),null!=(r=this.featureToggleProvider)&&r.isFeatureEnabled(a.oJ.DisableCertifiedAgentsOnly)||(t.certifiedAgentsOnly=!0);const i=await this.agentDirectoryProvider.listAgents(t);return{...i,items:i.items.filter(I).map((t=>this.applyCreatorTransformation(t)))}}async searchAgents(t,e={},n){var r,i;return null!=(r=this.featureToggleProvider)&&r.isFeatureEnabled(a.oJ.SetGoEntrypoint)&&(e.entrypoint=a.ZR.Go),null!=(i=this.featureToggleProvider)&&i.isFeatureEnabled(a.oJ.DisableCertifiedAgentsOnly)||(e.certifiedAgentsOnly=!0),(await this.agentDirectoryProvider.searchAgents(t,e,n)).filter(I).map((t=>this.applyCreatorTransformation(t)))}async listAgentInstances(){var t,e,n;if(!this.tenantId)throw new a.MY(a.MU.NotInitialized,"Service not initialized - tenant ID not available");const r=new Set(Object.keys(this.agentInstanceMap)),i=[],s=[];let o=0;let c=!0;for(;c;){const e=await this.agentDirectoryProvider.listAgentInstances(this.tenantId,{includePackListings:!0,limit:100,offset:o});i.push(...e.agentInstances||[]),null!=(t=e.packListings)&&t.length&&s.push(...e.packListings),c=void 0!==e.total&&o+e.agentInstances.length<e.total,o+=100}const l=i,d=new Set(l.map((t=>t.agentId)));let h=[];s.length>0?h=s:l.length>0&&(h=(await this.agentDirectoryProvider.listAgents({packIds:Array.from(d).map((t=>Number((0,a.Hr)(t))))})).items);const u=l.reduce(((t,e)=>{const n=t[e.agentId]||[];return t[e.agentId]=[...n,e],t}),{});for(const t of h){const e=u[t.id]||[];this.agentInstanceMap[t.id]={metadata:this.applyCreatorTransformation(t),instances:e},e.forEach((e=>{this.instanceIdToAgentIdMap[e.agentInstanceId]=t.id}))}for(const t of r)d.has(t)||(((null==(e=this.agentInstanceMap[t])?void 0:e.instances)||[]).forEach((t=>{delete this.instanceIdToAgentIdMap[t.agentInstanceId]})),delete this.agentInstanceMap[t]);return null==(n=this.reorderingService)||n.updateLocalOrderFromInstances(l),this.agentInstanceMap}getAgentInstancesForAgent(t){var e;return(null==(e=this.agentInstanceMap[t])?void 0:e.instances)||[]}getAgentIdForInstance(t){return this.instanceIdToAgentIdMap[t]}getAgentInstance(t,e){var n;return(null==(n=this.agentInstanceMap[t])?void 0:n.instances.find((t=>t.agentInstanceId===e)))??void 0}isAgentInstalled(t){return this.getAgentInstancesForAgent(t).length>0}listInstalledAgents(){if(!this.reorderingService)throw new a.MY(a.MU.NotInitialized,"Service not initialized - reordering service not available");return this.reorderingService.getCurrentOrderAgentIds().map((t=>this.agentInstanceMap[t])).filter((t=>t&&t.instances.length>0)).map((t=>{const e=t.instances[0].canReorder,n=t.instances[0].canDelete,r=!!t.instances[0].rootCsbIngestionId;return function({agentItem:t,canReorder:e,canDelete:n,hasData:r}){return{...t,status:a._W.Installed,canReorder:e,canDelete:n,hasData:r,renderPanel:()=>(0,l.jsx)(d.Suspense,{fallback:(0,l.jsx)("div",{}),children:(0,l.jsx)(y,{name:t.name,icon:t.icon})})}}({agentItem:{...t.metadata,status:a._W.Installed},canReorder:e,canDelete:n,hasData:r})}))}async addAgent(t){return this.agentDirectoryProvider.addAgent(t)}async createAgentInstance(t){if(!this.tenantId)throw new a.MY(a.MU.NotInitialized,"Service not initialized - tenant ID not available");const e=await this.agentDirectoryProvider.createAgentInstance(this.tenantId,t);return await this.listAgentInstances(),this.eventEmitter.emit("stateUpdated",{}),e}async createDefaultAgentInstances(t){if(!this.tenantId)return console.error("Service not initialized - tenant ID not available"),[];try{const e=new Set(Object.keys(this.agentInstanceMap));await this.agentDirectoryProvider.createDefaultAgentInstances(this.tenantId,t),await this.listAgentInstances();const n=[];for(const[t,r]of Object.entries(this.agentInstanceMap))!e.has(t)&&r.instances.length>0&&n.push(...r.instances);return this.eventEmitter.emit("stateUpdated",{}),n}catch(t){return console.error("Error in createDefaultAgentInstances:",t),[]}}async removeAgent(t){await Promise.all(this.getAgentInstancesForAgent(t).map((t=>this.agentDirectoryProvider.removeAgentInstance(t.agentInstanceId,t.tenantId)))),await this.listAgentInstances(),this.eventEmitter.emit("stateUpdated",{})}async removeAgentInstance(t,e){if(!this.tenantId)throw new a.MY(a.MU.NotInitialized,"Service not initialized - tenant ID not available");if(!this.getAgentInstance(t,e))throw new Error(`Agent instance with id '${e}' not found`);await this.agentDirectoryProvider.removeAgentInstance(e,this.tenantId),await this.listAgentInstances(),this.eventEmitter.emit("stateUpdated",{})}async refreshAgentInstances(){await this.listAgentInstances(),this.eventEmitter.emit("stateUpdated",{})}async setInstalledAgentsOrder(t,e){if(!this.reorderingService)throw new a.MY(a.MU.NotInitialized,"Service not initialized - reordering service not available");return this.reorderingService.reorderWithOptimisticUpdate(this.agentInstanceMap[t].instances[0],e?this.agentInstanceMap[e].instances[0]:void 0)}onAgentStateChanged(t){const e=this.eventEmitter.on("agentStateChanged",(e=>{t(e.agentId,e.agent)}));return()=>e.dispose()}onInstalledAgentsOrderChanged(t){const e=this.eventEmitter.on("installedAgentsOrderChanged",(e=>{t(e.agentIds)}));return()=>e.dispose()}onStateUpdated(t){const e=this.eventEmitter.on("stateUpdated",(()=>{t()}));return()=>e.dispose()}onDeeplinkRequested(t){const e=this.eventEmitter.on("deeplinkRequested",(e=>{t(e.request)}));return()=>e.dispose()}async getConnectionsInfoForUser(t){return this.agentDirectoryProvider.getConnectionsInfoForUser(t)}async getExternalPackMetadata(t){return this.agentDirectoryProvider.getExternalPackMetadata(t)}async getAgentMetadata(t,e){var n;if(!this.tenantId)throw new a.MY(a.MU.NotInitialized,"Service not initialized - tenant ID not available");const r=(null==(n=this.agentInstanceMap[t])?void 0:n.metadata)??await this.agentDirectoryProvider.getAgentPackListing(t),i=r.externalMetadataUrl,[s,o]=await Promise.all([null!=e&&e.includeExternalPackMetadata&&i?this.agentDirectoryProvider.getExternalPackMetadata(i):Promise.resolve(void 0),null!=e&&e.includeInstallationContext?this.agentDirectoryProvider.getAgentInstallationContext(this.tenantId,t):Promise.resolve(void 0)]);return{metadata:this.applyCreatorTransformation(r),installationContext:o,externalPackMetadata:s}}async requestDeeplink(t){this.eventEmitter.emit("deeplinkRequested",{request:t})}async getExecutionSummary(t){var e;if(!t.rootCsbIngestionId)return null;if(!this.tenantId)throw new a.MY(a.MU.NotInitialized,"Service not initialized - tenant ID not available");return(null==(e=(await this.agentDirectoryProvider.listIngestions(this.tenantId,{rootCsbIngestionId:t.rootCsbIngestionId})).result[0])?void 0:e.executionSummary)||null}async getSimplifiedRootIngestionSummary(t){if(!this.tenantId)throw new a.MY(a.MU.NotInitialized,"Service not initialized - tenant ID not available");return this.agentDirectoryProvider.getSimplifiedRootIngestionSummary(this.tenantId,t)}getConfiguredUrls(){return this.urls}getConfiguredUrl(t,e){const n=this.urls[t];return e?`${n}${e}`:n}}o.km.all;const P=Object.freeze({PROD:"https://coda.io",STAGING:"https://staging.coda.io",HEAD:"https://head.coda.io",DEV:"https://dev.coda.io:8080"}),v=(Object.freeze({PROD:"https://coda.grammarly.com",STAGING:"https://coda.ppgr.io",HEAD:"https://coda.qagr.io",DEV:"https://coda-local.ppgr.io:8080"}),Object.freeze({ListPacks:{path:"/apis/v1/packs/listings",queryParams:{CertifiedAgentsOnly:"certifiedAgentsOnly",Direction:"direction",PackEntrypoint:"packEntrypoint",IncludeBrainOnlyPacks:"includeBrainOnlyPacks",Limit:"limit",PageToken:"pageToken",PackIds:"packIds",SortBy:"sortBy"}},SearchPacks:{path:"/internalAppApi/packs/search",queryParams:{CertifiedAgentsOnly:"certifiedAgentsOnly",ExcludePackIds:"excludePackIds",PackEntrypoint:"packEntrypoint",IncludeBrainOnlyPacks:"includeBrainOnlyPacks",IncludePackIds:"includePackIds",Limit:"limit",Offset:"offset",PrioritizeAgentCertified:"prioritizeAgentCertified",Q:"q"}},CreateAgentInstance:{path:t=>`/internalAppApi/agentInstances/${t}`},DeleteAgentInstance:{path:(t,e)=>`/internalAppApi/agentInstances/${t}/${encodeURIComponent(e)}`},UserAccountInfo:{path:"/internalAppApi/account/userAccountInfo"},ListAgentInstances:{path:t=>`/internalAppApi/agentInstances/${t}`,queryParams:{Limit:"limit",Offset:"offset",IncludePackListings:"includePackListings"}},GetExternalConnections:{path:"/internalAppApi/account/externalConnections",queryParams:{PackId:"packId",IgnoreVersionsAfterLive:"ignoreVersionsAfterLive"}},BrainTenantId:{path:"/internalAppApi/agentInstances/brainTenantId"},ReorderAgents:{path:(t,e)=>`/internalAppApi/agentInstances/${t}/${encodeURIComponent(e)}/reorder`},CreateDefaultAgentInstances:{path:t=>`/internalAppApi/agentInstances/${t}/createDefaultAgentInstances`},ListPack:{path:t=>`/apis/v1/packs/${t}/listing`},GetCreateAgentInstanceContext:{path:t=>`/internalAppApi/agentInstances/${t}/createAgentInstanceContext`,queryParams:{PackId:"packId"}},ListIngestions:{path:t=>`/internalAppApi/csb/${t}/ingestions`,queryParams:{RootCsbIngestionId:"rootCsbIngestionId",IngestionName:"ingestionName",PackId:"packId",Limit:"limit",PageToken:"pageToken",OrderBy:"orderBy",Direction:"direction",Context:"context"}},GetSimplifiedRootIngestionSummary:{path:(t,e)=>`/internalAppApi/csb/${t}/ingestions/${e}/simplifiedSummary`}}));function A(t){var e,n,r;const s=(null==(n=null==(e=t.makers)?void 0:e[0])?void 0:n.name)||i.e.UNKNOWN;return{id:(0,a.QZ)(t.packId.toString()),name:t.name,icon:t.logoUrl||"https://coda.io/favicon.ico",logo:t.logo,creator:s,description:t.agentDescription||"No description available",shortDescription:t.agentShortDescription||"No short description available",agentImages:null==(r=t.agentImages)?void 0:r.map((t=>({imageUrl:t.imageUrl,assetId:t.assetId,filename:t.filename,mimeType:t.mimeType,altText:t.altText}))),privacyPolicyUrl:t.privacyPolicyUrl,termsOfServiceUrl:t.termsOfServiceUrl,externalMetadataUrl:t.externalMetadataUrl,certifiedAgent:t.certifiedAgent||!1,isPaidAgentFreeInBeta:t.isPaidAgentFreeInBeta||!1,releaseId:t.releaseId,lastReleasedAt:t.lastReleasedAt,supportEmail:t.supportEmail,disabled:t.disabled||!1}}const _=class extends h.K.Base{constructor(t,e,n){super(),this._url=t,this._ajaxFactory=e,this._fingerprints=n,this._ajax=this._ajaxFactory({credentials:"omit",requestExtender:u.d3.toHeaderAppender(this._fingerprints)})}static getDefaultUrl(t){switch(t){case".qagr.io":return P.HEAD;case".ppgr.io":return P.STAGING;default:return P.PROD}}async fetchAgents(t){if(t)return(await this.searchAgents(t)).map((t=>({...t,status:a._W.Uninstalled})));try{const{path:t,queryParams:e}=v.ListPacks,n=g.cl.get(`${this._url}${t}`).queryParam(e.Limit,100..toString());return(await this._ajax.json(n)).items.map((t=>({...A(t),status:a._W.Uninstalled})))}catch(t){throw console.error("Error fetching agents from Coda API:",t),t}}async listAgents(t={}){const e=t.nextPageToken?this.buildPaginatedRequest(t.nextPageToken):this.buildInitialRequest(t),n=await this._ajax.json(e);return{items:n.items.map((t=>A(t))),nextPageToken:n.nextPageToken}}buildInitialRequest(t){const e=this.applyDefaultOptions(t),{path:n,queryParams:r}=v.ListPacks,a=g.cl.get(`${this._url}${n}`);return this.addQueryParamsToRequest(a,r,e),a}buildPaginatedRequest(t){const{path:e,queryParams:n}=v.ListPacks,r=g.cl.get(`${this._url}${e}`);return r.queryParam(n.PageToken,t),r}applyDefaultOptions(t){const e=Object.fromEntries(Object.entries(t).filter((([,t])=>void 0!==t)));return{limit:c.C,includeBrainOnlyPacks:!0,sortBy:"agentDirectorySort",direction:"ascending",...e}}addQueryParamsToRequest(t,e,n){n.certifiedAgentsOnly&&t.queryParam(e.CertifiedAgentsOnly,"true"),n.packIds&&t.queryParam(e.PackIds,n.packIds.join(",")),void 0!==n.limit&&t.queryParam(e.Limit,n.limit.toString()),n.sortBy&&t.queryParam(e.SortBy,n.sortBy),n.direction&&t.queryParam(e.Direction,n.direction),void 0!==n.entrypoint&&t.queryParam(e.PackEntrypoint,n.entrypoint.toString()),void 0!==n.includeBrainOnlyPacks&&t.queryParam(e.IncludeBrainOnlyPacks,n.includeBrainOnlyPacks.toString())}async searchAgents(t,e={},n){try{const n={limit:c.C,offset:0,includeBrainOnlyPacks:!0,prioritizeAgentCertified:!0},r=Object.fromEntries(Object.entries(e).filter((([,t])=>void 0!==t))),a={...n,...r},{path:i,queryParams:s}=v.SearchPacks,o=g.cl.get(`${this._url}${i}`).queryParam(s.Q,(null==t?void 0:t.trim())??"");return void 0!==a.limit&&o.queryParam(s.Limit,a.limit.toString()),void 0!==a.offset&&o.queryParam(s.Offset,a.offset.toString()),a.includePackIds&&o.queryParam(s.IncludePackIds,a.includePackIds.join(",")),a.excludePackIds&&o.queryParam(s.ExcludePackIds,a.excludePackIds.join(",")),void 0!==a.includeBrainOnlyPacks&&o.queryParam(s.IncludeBrainOnlyPacks,a.includeBrainOnlyPacks.toString()),a.certifiedAgentsOnly&&o.queryParam(s.CertifiedAgentsOnly,"true"),void 0!==a.entrypoint&&o.queryParam(s.PackEntrypoint,a.entrypoint.toString().toLocaleUpperCase()),void 0!==a.prioritizeAgentCertified&&o.queryParam(s.PrioritizeAgentCertified,a.prioritizeAgentCertified.toString()),(await this._ajax.json(o)).hits.map((t=>A(t.listing)))}catch(t){throw console.error("Error searching agents from Coda API:",t),t}}async listAgentInstances(t,e){var n;const{path:r,queryParams:i}=v.ListAgentInstances,s=(null==e?void 0:e.limit)??100,o=(null==e?void 0:e.offset)??0,c=g.cl.get(`${this._url}${r(t)}`).queryParam(i.Limit,s.toString()).queryParam(i.Offset,o.toString());null!=e&&e.includePackListings&&c.queryParam(i.IncludePackListings,"true");const l=await this._ajax.json(c);return{agentInstances:l.agentInstances.sort(((t,e)=>{const n=t.assistantBenchDisplayOrder,r=e.assistantBenchDisplayOrder;return void 0===n&&void 0===r?0:void 0===n?1:void 0===r?-1:n-r})).map((t=>({...t,agentId:(0,a.QZ)(`${t.packId??""}`)}))),packListings:null==(n=l.packListings)?void 0:n.map((t=>A(t))),total:l.total}}async addAgent(t){return{agentId:t,agentInstanceId:"1",tenantId:"tenant-1",userId:"user-1",canReorder:!0,canDelete:!0}}async createAgentInstance(t,e){try{const n=`${this._url}${v.CreateAgentInstance.path(t)}`,r=g.cl.post(n).json(e),i=await this._ajax.json(r);return{agentId:(0,a.QZ)(e.packId.toString()),agentInstanceId:i.agentInstanceId,tenantId:t,userId:"current-user",canReorder:!0,canDelete:!0}}catch(t){throw console.error("Error creating agent instance:",t),t}}async createDefaultAgentInstances(t,e){try{const n=`${this._url}${v.CreateDefaultAgentInstances.path(t)}`,r=g.cl.post(n).json({userRole:e});return await this._ajax.json(r),[]}catch(t){return console.error("Error creating default agent instances:",t),[]}}async editAgentInstance(t,e,n){return{agentId:t,agentInstanceId:"1",tenantId:"tenant-1",userId:"user-1",canReorder:!0,canDelete:!0}}async removeAgentInstance(t,e){try{const n=v.DeleteAgentInstance.path(e,t),r=g.cl.del(`${this._url}${n}`);if(!(await this._ajax.json(r)).success)throw new Error(`Failed to delete agent instance: ${t}`)}catch(t){throw console.error("Error removing agent instance:",t),t}}async getUserAccountInfo(){try{const t=`${this._url}${v.UserAccountInfo.path}`,e=g.cl.get(t).json();return await this._ajax.json(e)}catch(t){throw console.error("Error fetching user account info:",t),t}}async getBrainTenantId(){try{const t=`${this._url}${v.BrainTenantId.path}`,e=g.cl.post(t).json();return await this._ajax.json(e)}catch(t){throw console.error("Error fetching brain tenant ID:",t),t}}async saveInstalledAgentsOrder(t,e,n){try{const r=v.ReorderAgents.path(t,e),a=g.cl.post(`${this._url}${r}`),i={};if(n&&(i.nextAgentInstanceId=n),a.json(i),!(await this._ajax.json(a)).success)throw new Error(`Failed to reorder agent instance: ${e}${n?` before ${n}`:" to the end"}`)}catch(t){throw console.error("Error reordering agent instances:",t),t}}async getConnectionsInfoForUser(t){try{const{path:e,queryParams:n}=v.GetExternalConnections,r=g.cl.get(`${this._url}${e}`);return r.queryParam(n.PackId,t.packId),void 0!==t.ignoreVersionsAfterLive&&r.queryParam(n.IgnoreVersionsAfterLive,t.ignoreVersionsAfterLive.toString()),await this._ajax.json(r)}catch(t){throw console.error("Error fetching connections info for user:",t),t}}async getExternalPackMetadata(t){try{const e=g.cl.get(t);return await this._ajax.json(e)}catch(t){throw console.error("Error fetching external pack metadata:",t),t}}async getAgentPackListing(t){const e=(0,a.Oo)(t),n=`${this._url}${v.ListPack.path(e)}`,r=g.cl.get(n);return A(await this._ajax.json(r))}async getAgentInstallationContext(t,e){try{const n=(0,a.Oo)(e),r=`${this._url}${v.GetCreateAgentInstanceContext.path(t)}`,i=g.cl.get(r).queryParam(v.GetCreateAgentInstanceContext.queryParams.PackId,n.toString());return await this._ajax.json(i)}catch(t){throw console.error("Error fetching agent installation context:",t),t}}async listIngestions(t,e){try{const{path:n,queryParams:r}=v.ListIngestions,a=g.cl.get(`${this._url}${n(t)}`);return null!=e&&e.rootCsbIngestionId&&a.queryParam(r.RootCsbIngestionId,e.rootCsbIngestionId),null!=e&&e.ingestionName&&a.queryParam(r.IngestionName,e.ingestionName),void 0!==(null==e?void 0:e.packId)&&a.queryParam(r.PackId,e.packId.toString()),void 0!==(null==e?void 0:e.limit)&&a.queryParam(r.Limit,e.limit.toString()),null!=e&&e.pageToken&&a.queryParam(r.PageToken,e.pageToken),null!=e&&e.orderBy&&a.queryParam(r.OrderBy,e.orderBy),null!=e&&e.direction&&a.queryParam(r.Direction,e.direction),null!=e&&e.context&&a.queryParam(r.Context,e.context),await this._ajax.json(a)}catch(t){throw console.error("Error listing ingestions:",t),t}}async getSimplifiedRootIngestionSummary(t,e){try{const{path:n}=v.GetSimplifiedRootIngestionSummary,r=g.cl.get(`${this._url}${n(t,e)}`);return await this._ajax.json(r)}catch(t){throw console.error("Error fetching simplified root ingestion summary:",t),t}}};_.ID="CodaAgentDirectory"},62220:(t,e,n)=>{n.d(e,{v:()=>r});class r{listeners=new Map;on(t,e){return this._getOrInitializeListeners(t).add(e),{dispose:()=>{this.listeners.get(t)?.delete(e)}}}emit(t,e){const n=this.listeners.get(t);if(n)for(const r of n)try{r(e)}catch(e){console.error(`Error in event listener for event "${String(t)}":`,e)}}_getOrInitializeListeners(t){return this.listeners.has(t)||this.listeners.set(t,new Set),this.listeners.get(t)}}},10153:(t,e,n)=>{n.d(e,{cl:()=>y});var r,a,i,s,o,c=n(20232),l=n(43351),d=n(58303),h=n(10444),u=n(32103),g=n(48886);(t=>{t.extend=function(t){return g.I_((e=>({...e,requestExtender:e.requestExtender?y.Extender.compose(t,e.requestExtender):t})))};class e extends u.sH{constructor(t,e){super(t),this.message=t,this.details=e,this.name="ParseError"}toString(){return`Ajax response parsing error\n        Message ${this.message}\n        Details ${l.Rn(this.details).join("\n")}`}}var n;t.ParseError=e,(n=t.MimeType||(t.MimeType={})).json="application/json",n.form="application/x-www-form-urlencoded",n.multipart="multipart/form-data",n.pdf="application/pdf",n.txt="text/plain",n.stream="application/octet-stream",n.vnd="application/vnd",n.zip="application/zip",n.any="*/*",t.mapToHTTPErrorWithoutBody=function(e,n,r){return r.removeBody(),t.mapToHTTPError(e,n,r)},t.mapToHTTPError=function(t,e,n){return new m({request:n,code:e.status,status:e.statusText,url:e.url,body:t})}})(r||(r={}));class m extends u.sH{constructor({code:t,status:e,url:n,message:r,body:a,request:i}){super(r||(e||a?e||a:"HTTPError")),this.name="HTTPError",this.url=n,this.code=t,this.body=a,this.status=e,this.request=i}toString(){return`Response\n      Message: ${this.message}\n      Status: ${this.status}\n      Code: ${this.code}\n      Body: ${this.body}\n      ${void 0!==this.request?"\n"+this.request.toString():`Url: ${this.url}`}`}}class p{constructor(t,e,n,r,a,i){this._url=t,this._method=e,this._headers=n,this._mime=r,this._body=a,this._keepalive=i}static get(...t){return y.get(...t).build()}static post(...t){return y.post(...t).build()}static put(...t){return y.put(...t).build()}static del(...t){return y.del(...t).build()}static head(...t){return y.head(...t).build()}get url(){return this._url}get method(){return this._method}get headers(){return this._headers}get mime(){return this._mime}get keepalive(){var t;return null!=(t=this._keepalive)&&t}get body(){return d.ij(this._body)}toString(){return`Request\n    Method: ${this.method.toUpperCase()}\n    Url: ${this.url}\n    Mime: ${this.mime}\n    Headers: ${JSON.stringify(this.headers,void 0,2)}\n    Body:${h.dH((t=>{return e=JSON.stringify(t instanceof URLSearchParams?function(t){const e={};return t.forEach(((t,n)=>e[n]=t)),e}(t):t,void 0,2),n=200,e.length<=n?e:e.slice(0,n)+"....";var e,n}),"empty")(this.body)}\n    `}removeBody(){this._body=void 0}}a=p||(p={}),(i=a.Method||(a.Method={})).GET="GET",i.POST="POST",i.PATCH="PATCH",i.PUT="PUT",i.OPTIONS="OPTIONS",i.HEAD="HEAD",i.TRACE="TRACE",i.DELETE="DELETE",i.CONNECT="CONNECT";class y{constructor(t="",e=new URLSearchParams,n=[],r={},a,i,s,o=!1,c=!1){this._url=t,this._queryParams=e,this._cookies=n,this._headers=r,this._method=a,this._mime=i,this._body=s,this._preserveUrl=o,this._keepalive=c}static join(...t){const e=[].slice.call(t.filter((t=>t.length>0)),0).join("/");return y._normalize(e)}static _normalize(t){return t=(t=(t=t.replace(/:\//g,"://")).replace(/([^:\s])\/+/g,"$1/")).replace(/\/(\?|#)/g,"$1")}static get(...t){return y.url(...t).method("GET")}static post(...t){return y.url(...t).method("POST")}static put(...t){return y.url(...t).method("PUT")}static patch(...t){return y.url(...t).method("PATCH")}static del(...t){return y.url(...t).method("DELETE")}static head(...t){return y.url(...t).method("HEAD")}static url(...t){return new y(y.join(...t))}url(...t){if(""!==this._url)throw new Error("URL already set to "+this._url+", use join(string) to add additional parts to it");return this.join(y.join(...t))}static create(){return new y}method(t){if(Boolean(this._method)&&this._method!==t)throw new Error("Method already set to "+this._method+", but was overwritten by "+t);return this._method=t,this}join(t){return this._url=y.join(this._url,t),this}pathParam(t){return this._url=y.join(this._url,encodeURIComponent(t)),this}body(t){if(this._body)throw new Error("Body already set to "+this._body+", but was overwritten by "+t);return this._body=t,this}formParam(t,e){return(this._body=this._body instanceof URLSearchParams?this._body:new URLSearchParams).append(t,e),this}multipartFormData(t,e,n){const r=this._body instanceof FormData?this._body:new FormData;return n?r.append(t,e,n):r.append(t,e),this._body=r,this}header(t,e){return this._headers[t]=e,this}queryParam(t,e){return this._queryParams.append(t,e),this}queryParams(t){return Object.entries(t).forEach((([t,e])=>this._queryParams.append(t,e))),this}cookie(t,e){return this._cookies.push(t+"="+e),this}mime(t){if(Boolean(this._mime)&&this._mime!==t)throw new Error("MIME already set to "+this._mime+", but was overwritten by "+t);return this._mime=t,this}keepalive(){return this._keepalive=!0,this}json(t){return t?this.body(t).mime("application/json"):this.mime("application/json")}preserveUrl(){return this._preserveUrl=!0,this}build(){var t;if(!this._url||0===this._url.length)throw new Error("URL cannot be empty");if(this._preserveUrl||(this._url=this._url.replace(/\/$/,"")),`${this._queryParams}`.length>0&&(this._url+="?"+this._queryParams),this._body instanceof URLSearchParams){if(Boolean(this._mime)&&"application/x-www-form-urlencoded"!==this._mime)throw new Error("Only application/x-www-form-urlencoded can be used for form requests, don't specify it mandatory in mime() method");this._mime="application/x-www-form-urlencoded"}else if(this._body instanceof FormData&&Boolean(this._mime)&&"multipart/form-data"!==this._mime)throw new Error("Only multipart/form-data can be used for multipart form data requests, don't specify it mandatory in mime() method");if("application/json"===this._mime&&Boolean(this._body)&&(this._body=JSON.stringify(this._body)),!this._method)throw new Error("HTTP method was not set");if("GET"===this._method&&this._body)throw new Error("Body is not supported for GET");if(this._mime&&(this._headers["Content-Type"]=this._mime),this._cookies.length>0){const t="Cookie";this._headers[t]=this._cookies.join("; ")}return new p(this._url,this._method,this._headers,this._mime||null,this._body,null!=(t=this._keepalive)&&t)}}s=y||(y={}),(o=s.Extender||(s.Extender={})).identity=t=>c.oE.of(t),o.compose=(...t)=>e=>t.reduce(c.oE.chain,(0,o.identity)(e))},63978:(t,e,n)=>{var r;n.d(e,{K:()=>r}),(r||(r={})).Base=class{}},22980:(t,e,n)=>{var r;n.d(e,{d3:()=>r}),(r||(r={})).toHeaderAppender=function(t){return function(t){async function e(t){if(Array.isArray(t)){const[e,n]=t,r=await("function"==typeof n?n():n);return r?[e,r].join(" "):void 0}return await("function"==typeof t?t():t)}return n=>async()=>{for(const r in t){const a=await e(t[r]);void 0!==a&&n.header(r,a)}return n}}({"X-Client-Version":t.clientVersion.toString(),"X-Client-Type":()=>t.clientName,"X-Container-Id":t.containerId,"X-CSRF-Token":t.csrfToken,...void 0!==t.accessToken&&{Authorization:["Bearer",t.accessToken]}})}}}]);