(self.webpackChunk=self.webpackChunk||[]).push([[6011],{85807:(e,t,n)=>{n.d(t,{A:()=>o,C:()=>i});const i="vBars",o="grammarly-extension-vBars"},58611:(e,t,n)=>{n.r(t),n.d(t,{Coda:()=>i,getHideGrammarlyWhenTextFieldIsUnderAnimationSub:()=>j,getInjectionLayoutForGButtonForDocument:()=>O,injectIntegrationRootForMainCanvasOnly:()=>P,isMainCanvas:()=>N});var i,o=n(84714),a=n(44071),r=n(64271),l=n(59179),d=n(24666),s=n(90572),u=n(63532),c=n(20161),p=n(18827),m=n(14969),g=n(65311),f=n(13391),h=n(2187),b=n(85807),C=n(90595),E=n(20905),y=n(808),T=n(49629),v=n(31394),x=n(68418),A=n(44287),I=n(18647),B=n(948),R=n(27970),S=n(22234),k=n(44991),G=n(26761),U=n(95523),_=n(15082),w=n(85452),H=n(26742),M=n(3670),F=n(33357),D=n(18122);!function(e){function t({changes:e,deltaChange:t}){return e.length>0||t.delta.ops.length>0}function n(n){const i=(0,_.B)(n.field),o=n.experimentClient.isGateEnabled(C.K.CodaUseCSSTransformTranslateForUnderlinePosition),a=n.experimentClient.isGateEnabled(C.K.CodaPositionGbuttonIntoFixedContainer);let r={};if(a){const e=document.querySelector('[data-coda-ui-id="help-button"]');(null==e?void 0:e.parentElement)&&N(n.field)&&(r={...r,...O(e.parentElement)}),r={...r,injectIntegrationRoot:t=>{P(t,e)}}}const s=[],u=f.h.create(!1),c=n.experimentClient.isGateEnabled(C.K.CodaHideUnderlineWhenAnimated),p=n.field.firstElementChild,m=T.S.sec1.pipe((0,l.U)((()=>{var e;for(const t of document.querySelectorAll("span[role=button]"))if("Suggesting edits"===(null===(e=t.textContent)||void 0===e?void 0:e.trim()))return!0;return!1})),(0,d.x)(((e,t)=>e===t)));return{createLayout:()=>(s.push(m.subscribe(h.wW(u))),c&&p&&s.push(j(p)),new A.A7(n.field,{...r,createGbuttonShiftBehavior:()=>u.view((e=>e?{top:self.innerHeight,left:self.innerWidth}:{top:0,left:0})),getFieldSize:(e,t)=>{if(u.get())return{width:0,height:0};const n=o&&e.firstElementChild?(0,I.Bi)(self.getComputedStyle(e.firstElementChild)):void 0;return{width:t.width-((null==n?void 0:n.x)||0),height:t.height-((null==n?void 0:n.y)||0)}}})),createSelectionSource:()=>i,createTextObserver:()=>new H.j(n.field,B.k.fromDiff,i,void 0,e.createTextMapWithoutCodeBlocks,t),extraCondition:()=>y.T.isSupported(),createReplacementService:e=>new R.V0({eventTarget:n.field,textObserver:e,asyncReplaceDelay:100,deletionEvent:"paste",experimentClient:n.experimentClient,transformReplacementBeforeApply:(e,t)=>n.experimentClient.isGateEnabled(C.K.CodaTransformDeleteReplacement)?(0,k.ig)(e,t.getCurrentTextMap()):e}),validationRules:[...G.u,(0,U.Uo)(20,135)],onDispose:()=>{s.forEach((e=>e.unsubscribe()))}}}e.MIX_MIN_TEXTAREA_HEIGHT_FOR_GBUTTON=35,e.TEXTAREA_CODA_UI_IDS=["page-title","page-subtitle","page-list-item-title","hyperlink-builder-text-input"],e.isNonEmptyChange=t,e.createTextMapWithoutCodeBlocks=e=>w.Z.create(e,{andFilterNode:(e,t)=>!e.classList.contains("kr-code-block")}),e.shouldHideGButtonInTextarea=t=>{const n=t.editorElement.getAttribute("data-coda-ui-id"),i=t.editorElement.getBoundingClientRect().height;return n&&e.TEXTAREA_CODA_UI_IDS.includes(n)||i<e.MIX_MIN_TEXTAREA_HEIGHT_FOR_GBUTTON},e.getContentIntegrationConfigure=n,e.validateElementByCodaUiId=(e,t)=>({ruleName:e,match:(e,n)=>n.field.getAttribute("data-coda-ui-id")!==t}),e.content=S.T.contentEditable("CodaIO.content",n),e.textareaRule=S.T.textarea("generic",(t=>{const n=t.experimentClient.isGateEnabled(C.K.CodaHideGbuttonForDocumentTitle);return{gbuttonMinimizeState:(0,o.of)(!0),createLayout:()=>new A.A7(t.field,{injectIntegrationRoot:t=>{"gbutton"===t.grammarlyPart&&n&&e.shouldHideGButtonInTextarea(t)||(0,A.Ry)(t)}}),validationRules:[...G.u,(0,U.Uo)(20,45),e.validateElementByCodaUiId("skipTableTitle","tableTitle"),e.validateElementByCodaUiId("skipSharingDialogEmailInput","sharing-dialog-email-input"),e.validateElementByCodaUiId("skipEmbedHyperlinkBuilder","embedHyperlinkBuilder"),e.validateElementByCodaUiId("skipPageAuthorsInput","page-authors-input")]}})),e.page=(0,M.$W)({name:"coda",domain:D.LF},[e.content,F.k.iframeHostRule,e.textareaRule])}(i||(i={}));const O=e=>({customGbuttonPositioning:{injectionElement:e,injectionStyle:{top:"-5px",right:"0px"},createPositionStyleBehavior:e=>e.pipe(l.U((e=>({position:"absolute",width:"auto",height:"auto",pointerEvents:"all",right:-e.left+"px",bottom:-e.top+"px"})))),calculateMetrics:(e,t,n)=>{const i=x.p8.create({top:n.top+-5,left:e.size.width-n.left});return{offset:i,page:x.Cv.fromOffset(i,x.Cv.fromClient(e.client,{top:t.scrollY,left:t.scrollX}),{top:0,left:0}),client:x.Ir.create(x.E9.plus(e.client,i)),effectivePadding:{top:0,right:0,bottom:0,left:0},size:v.V.gButtonMaxSize}}}}),P=(e,t)=>{("gbutton"!==e.grammarlyPart||N(e.editorElement))&&("gbutton"===e.grammarlyPart&&N(e.editorElement)&&!t||(0,A.Ry)(e))},N=e=>e.parentElement&&!(0,g.q2)(e.parentElement,"data-coda-ui-id","editable"),j=e=>{const t=()=>[...document.getElementsByTagName(A.Mf),...document.getElementsByTagName(b.A)],n="data-temp-style";let i=!1;return(0,a.R)(e,"animationstart").pipe((0,s.h)((()=>!i)),(0,u.b)((()=>{i=!0;for(const e of t()){const t=e.getAttribute("style");t&&e.setAttribute(n,t),e.setAttribute("style","display: none")}})),(0,c.w)((()=>(0,r.T)((0,a.R)(e,"animationend").pipe((0,p.g)(E.E0)),T.S.sec2).pipe((0,m.P)())))).subscribe((()=>{for(const e of t()){const t=e.getAttribute(n);t?(e.setAttribute("style",t),e.removeAttribute(n)):e.removeAttribute("style")}i=!1}))}}}]);