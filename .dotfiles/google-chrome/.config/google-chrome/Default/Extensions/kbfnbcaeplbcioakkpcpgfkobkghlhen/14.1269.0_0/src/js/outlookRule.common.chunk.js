(self.webpackChunk=self.webpackChunk||[]).push([[8105],{43324:(t,e,i)=>{i.r(e),i.d(e,{Outlook:()=>P,findScrollContainer:()=>M,findSendButtonContainer:()=>A,getInjectionLayoutForGButtonInSendContainer:()=>j,getInjectionLayoutForStickyGButtonOnTheBottom:()=>R,getInjectionLayoutOptions:()=>z,getToolbarPosition:()=>U,getVBarsIntegrationInfo:()=>T});var o=i(59179),n=i(954),r=i(58303),s=i(49629),l=i(9194),a=i(31394),u=i(68418),c=i(63866),d=i(44287),g=i(18647),p=i(22234),m=i(96075),h=i(20161),y=i(84308),f=i(84766),S=i(14969),_=i(91089),v=i(31603),b=i(90572),E=i(24666),x=i(32073),B=i(45523),C=i(40594);class w{constructor(){this._logger=C.Y.create("NativeSuggestionsToggler"),this._elementsSubs=null,this._squigglers=[]}set ctx(t){this._ctx=t}static getInstance(t){return this._instance||(this._instance=new w),this._instance.ctx=t,this._instance}static _isElementNode(t){return t.nodeType===Node.ELEMENT_NODE}_waitForSquigglers(){return this._ctx.field.parentElement?B.x.create(this._ctx.field.parentElement,{childList:!0}).pipe(n.O([{target:this._ctx.field.parentElement,type:"childList"}]),h.w((t=>{for(const e of t)if("childList"===e.type&&w._isElementNode(e.target)){const t=Array.from(e.target.querySelectorAll("div.ms-editor-squiggler"));return y.a(t.map((t=>f.F(100).pipe(o.U((()=>t.shadowRoot)),S.P((t=>Boolean(t)))))))}return _.C})),h.w((t=>y.a(t.map((t=>{const e=t.querySelector("div");return e?B.x.create(e,{childList:!0}).pipe(n.O([{target:e,type:"childList"}])):_.C}))).pipe(v.J()))),o.U((t=>{for(const e of t)if("childList"===e.type&&w._isElementNode(e.target)){const t=e.target.querySelectorAll('span[role="status"]');return t?Array.from(t):null}return null})),b.h((t=>Boolean(t))),o.U((t=>t.filter((t=>"none"!==t.style.display)))),b.h((t=>t.length>0)),E.x(((t,e)=>t.reduce(((t,e)=>t+e.style.display),"")===e.reduce(((t,e)=>t+e.style.display),"")))):_.C}_waitForEditorCard(){return B.x.create(this._ctx.field.ownerDocument.documentElement,{childList:!0}).pipe(o.U((t=>{var e;for(const i of t)if("childList"===i.type&&w._isElementNode(i.target))return null!==(e=i.target.querySelector("editor-card"))&&void 0!==e?e:null;return null})),S.P((t=>Boolean(t))))}_waitForPremiumBadge(){return this._ctx.field.parentElement?B.x.create(this._ctx.field.parentElement,{childList:!0}).pipe(o.U((t=>{var e,i,o,n;for(const r of t)if("childList"===r.type&&w._isElementNode(r.target)){const t=r.target.querySelector('button[type="button"] > span > i[data-icon-name="Diamond"]');return null!==(n=null===(o=null===(i=null===(e=null==t?void 0:t.parentElement)||void 0===e?void 0:e.parentElement)||void 0===i?void 0:i.parentElement)||void 0===o?void 0:o.parentElement)&&void 0!==n?n:null}return null})),b.h((t=>Boolean(t))),b.h((t=>"none"!==t.style.display)),E.x(((t,e)=>t.style.display===e.style.display))):_.C}hideSuggestions(){this._elementsSubs=new x.w0,this._elementsSubs.add(this._waitForSquigglers().subscribe((t=>{t&&(this._logger.trace("Hiding Outlook's native suggestions underlines.",t),this._squigglers=this._squigglers.concat(t),this._originalSquigglerDisplayStyle||(this._originalSquigglerDisplayStyle=t[0].style.display),this._squigglers.forEach((t=>{t.style.display="none"})))}))),this._elementsSubs.add(this._waitForEditorCard().subscribe((t=>{t&&(this._logger.trace("Hiding Outlook's native suggestions cards."),this._editorCard=t,this._originalEditorCardDisplayStyle=this._editorCard.style.display,this._editorCard.style.display="none")}))),this._elementsSubs.add(this._waitForPremiumBadge().subscribe((t=>{t&&(this._logger.trace("Hiding Outlook's native suggestions premium badge."),this._premiumBadge=t,this._originalPremiumBadgeDisplayStyle=this._premiumBadge.style.display,this._premiumBadge.style.display="none")})))}showSuggestions(){var t;this._squigglers.length>0&&(this._logger.trace("Restoring Outlook's native suggestions underlines."),this._squigglers.forEach((t=>{t.style.display=this._originalSquigglerDisplayStyle}))),this._editorCard&&(this._logger.trace("Restoring Outlook's native suggestions cards."),this._editorCard.style.display=this._originalEditorCardDisplayStyle),this._premiumBadge&&(this._logger.trace("Restoring Outlook's native suggestions premium badge."),this._premiumBadge.style.display=this._originalPremiumBadgeDisplayStyle),null===(t=this._elementsSubs)||void 0===t||t.unsubscribe(),this._elementsSubs=null}}var k,q=i(85452),L=i(47557);!function(t){const e=t=>"BLOCKQUOTE"===t.tagName&&(0,L.Re)(t)&&""!==t.style.borderLeft;t.createEditorTextMap=t=>q.Z.create(t,{andNodeFormatting:(t,i)=>"BLOCKQUOTE"===t.tagName?e(t)?{...i,blockquote:!0}:{...i}:"Signature"===t.id?{...i,signature:!0}:q.Z.defaultNodeFormatting(t,i),overrideFilterNode:(t,i)=>q.Z.defaultFilterNodeAllowingBlockquote(t,i)&&!e(t)})}(k||(k={}));var O,F=i(25292);!function(t){t.getAuthorDomain=function(){const t=document.querySelector('[href*="https://outlook.com?login_hint"]');if(t){const e=F.X.getDomainFromEmail(decodeURIComponent(t.href));if(e)return e}const e=document.querySelector("[id*=primaryMailboxRoot_]");if(e){const t=F.X.getDomainFromEmail(e.id);if(t)return t}return null}}(O||(O={}));var I=i(18122),D=i(3670);const N=C.Y.create("universal.cs.integration.rules.mail.outlook"),T=(t,e)=>r.G({kind:"outlook",integrationName:t,domain:e.pageContext.domain,isInsideIFrame:!1}),M=t=>(0,g.wr)(t,(t=>t.classList.contains("owaMailComposeEditorScrollContainer")))||(0,g.wr)(t,(t=>t.classList.contains("customScrollBar")))||(0,g.wr)(t,(t=>{const e=getComputedStyle(t);return"auto"===e.overflowY||"scroll"===e.overflowY}))||t,A=t=>{var e;return t.querySelector("[data-testid=ComposeSendButton]")||t.querySelector("div[aria-label='Send'][role='button']")||(null===(e=t.querySelector('button[type="button"].ms-Button.ms-Button--primary.ms-Button--hasMenu'))||void 0===e?void 0:e.closest('div[role="button"]'))||t.querySelector(".fui-SplitButton")||document.querySelector("[data-testid=ComposeSendButton]")||document.querySelector(".fui-SplitButton")};var P;!function(t){t.page=(0,D.$W)({name:"outlook",domain:I.ph},[p.T.contentEditable("Outlook",(t=>({createLayout:t=>{const e=M(t),i=A(e);if(!i)return N.warn("Outlook Send button not found in compose area."),new d.A7(t,{scroller:(0,c.z)(e)||t,transformElement:{getValue:(t,i)=>(0,g.f0)(e,i),getIndicator:()=>e}});const o=(0,g.bp)(i),n=U(o),r=z(n,o);return new d.A7(t,{scroller:(0,c.z)(e)||t,...r,transformElement:{getValue:(t,i)=>(0,g.f0)(e,i),getIndicator:()=>e}})},customizations:{richText:l.kn.isAvailable(t),applyFormatting:!0},textMap:{createFieldTextMap:k.createEditorTextMap},onCreate:()=>w.getInstance(t).hideSuggestions(),onDispose:()=>w.getInstance(t).showSuggestions(),getFromEmailDomainAndSignature:t=>function(t){const e=O.getAuthorDomain(),i=F.X.getSignature(t);return{fromEmailDomain:e,emailSignature:i}}(t),getVBarsIntegrationInfo:e=>T(e,t)}))),p.T.textarea("Outlook",(t=>({createLayout:()=>new d.A7(t.field,{gbuttonMinPadding:m.rR}),textMap:{createFieldTextMap:k.createEditorTextMap}})))])}(P||(P={}));const U=t=>{const e=getComputedStyle(t);return"sticky"===e.position&&"0px"===e.top?"topSticky":"sticky"===e.position&&"0px"===e.bottom?"bottomSticky":"unknown"},R=()=>({highlightsLayoutOptions:{fixUIGlitchesByForcingStackingContext:!0}}),j=t=>({customGbuttonPositioning:{injectionElement:t,injectionStyle:{top:"0",right:"0"},createPositionStyleBehavior:t=>t.pipe(o.U((t=>({position:"absolute",transform:"translate(0, -100%)",width:"auto",height:"auto",pointerEvents:"all",right:-t.left+"px",top:`${t.top}px`})))),calculateMetrics:(t,e,i)=>{const o=u.p8.create({top:i.top,left:t.size.width+i.left});return{offset:o,page:u.Cv.fromOffset(o,u.Cv.fromClient(t.client,{top:e.scrollY,left:e.scrollX}),{top:0,left:0}),client:u.Ir.create(u.E9.plus(t.client,o)),effectivePadding:{top:0,right:14,bottom:14,left:0},size:a.V.gButtonMaxSize}},createShiftBehavior:()=>s.S.sec1.pipe(o.U((()=>document.querySelector('button[aria-label*="Microsoft Editor"]')?{top:-11,left:-50}:{top:-14,left:-14})),n.O({top:-14,left:-14}))}}),z=(t,e)=>"unknown"===t?{}:"topSticky"===t?R():j(e)},25292:(t,e,i)=>{i.d(e,{X:()=>o});var o,n=i(71576);!function(t){t.getSignature=function(t){const e=[];t.getRichText().eachLine(((t,i)=>(!0===i.signature&&e.push(t),!0)));const i=e.map((t=>t.ops.reduce(((t,e)=>n.s.isInsertString(e)&&e.insert?t+e.insert:t),"")));return i.length?i.join(";"):null},t.getDomainFromEmail=function(t){const e=t.indexOf("@");return e>=0?t.substring(e+1):null}}(o||(o={}))}}]);